(this["webpackJsonpreact-admin"]=this["webpackJsonpreact-admin"]||[]).push([[0],{1263:function(e,t,a){},1264:function(e,t,a){},1265:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(11),o=a.n(c),l=a(17),s=a(18),i=a(20),u=a(19),m=a(21),p=a(107),d=a(126),h=(a(573),a(176)),f={user:{}},y=(a(110),a(5)),g=(a(576),a(127)),b=(a(579),[{title:"\u9996\u9875",key:"/home",icon:"home",isPublic:!0},{title:"\u5546\u54c1",key:"/products",icon:"appstore",children:[{title:"\u54c1\u7c7b\u7ba1\u7406",key:"/category",icon:"bars"},{title:"\u5546\u54c1\u7ba1\u7406",key:"/product",icon:"tool"}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/user",icon:"user"},{title:"\u89d2\u8272\u7ba1\u7406",key:"/role",icon:"safety"},{title:"\u56fe\u5f62\u56fe\u8868",key:"/charts",icon:"area-chart",children:[{title:"\u67f1\u5f62\u56fe",key:"/charts/bar",icon:"bar-chart"},{title:"\u6298\u7ebf\u56fe",key:"/charts/line",icon:"line-chart"},{title:"\u997c\u56fe",key:"/charts/pie",icon:"pie-chart"}]},{title:"\u8ba2\u5355\u7ba1\u7406",key:"/order",icon:"windows"}]),v=a(123),E=a(22),O=a.n(E),k=a(34),w=a(257),j=(a(101),a(42)),C=a(354),S=a.n(C);function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise((function(n,r){("GET"===a?S.a.get(e,{params:t}):S.a.post(e,t)).then((function(e){n(e)})).catch((function(e){j.a.error("\u8bf7\u6c42\u51fa\u9519\u4e86")}))}))}var N=a(543),I=a.n(N),_=function(e,t){return x("/users",{username:e,password:t},"POST")},T=function(e){return x("/users/add",e,"POST")},A=function(e){return new Promise((function(t,a){var n="http://api.map.baidu.com/telematics/v3/weather?location=".concat(e,"&output=json&ak=3p49MVra6urFRGOT9s8UBWr2");I()(n,{},(function(e,a){if(e||"success"!==a.status)j.a.error("\u83b7\u53d6\u5929\u6c14\u4fe1\u606f\u5931\u8d25");else{var n=a.results[0].weather_data[0],r=n.dayPictureUrl,c=n.weather;t({dayPictureUrl:r,weather:c})}}))}))},P=function(e){return x("/users/categorys",{parentId:e},"GET")},M=function(e,t){return x("/users/addcategorys",{categoryName:e,parentId:t},"POST")},F=function(e,t){return x("/users/updatecategorys",{categoryId:e,categoryName:t},"POST")},D=function(e,t){return x("/users/productslist",{pageNum:e,pageSize:t})},U=function(e){var t=e.pageNum,a=e.pageSize,n=e.searchName,r=e.searchType;return x("/users/productsearch",Object(w.a)({pageNum:t,pageSize:a},r,n))},L=function(e){return x("/users/categoryinfo",{categoryId:e})},R=function(e,t){return x("/users/updatestatus",{productId:e,status:t},"POST")},V=function(e){return x("/users/deleteimg",{name:e},"POST")},W=function(e){return x("/users/product"+(e._id?"update":"add"),e,"POST")},z=function(e){return x("/users/updaterole",e,"POST")},K=function(){return x("/users/getAll")},q=function(e){return x("/user/delete",{userId:e},"POST")},Y=a(271),B=a.n(Y),H=function(e){B.a.set("user_key",e)},G=function(){return B.a.get("user_key")||{}},J=function(){B.a.remove("user_key")},X=function(e){return{type:"recerive_user",user:e}},Q=g.a.SubMenu,Z=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={collapsed:!1},a.getMenuNodes_map=function(e){return e.map((function(e){return e.children?r.a.createElement(Q,{key:e.key,title:r.a.createElement("span",null,r.a.createElement(y.a,{type:e.icon}),r.a.createElement("span",null,e.title))},a.getMenuNodes(e.children)):r.a.createElement(g.a.Item,{key:e.key},r.a.createElement(p.b,{to:e.key},r.a.createElement(y.a,{type:e.icon}),r.a.createElement("span",null,e.title)))}))},a.hasAuth=function(e){var t=e.key,a=e.isPublic,n=f.user.username,r=f.user.role.menus;return!("crc"!==n&&!a&&-1===r.indexOf(t))||(e.children?!!e.children.find((function(e){return-1!==r.indexOf(e.key)})):void 0)},a.getMenuNodes=function(e){var t=a.props.location.pathname;return e.reduce((function(e,n){a.hasAuth(n)&&(n.children?(n.children.find((function(e){return 0===t.indexOf(e.key)}))&&(a.openKey=n.key),e.push(r.a.createElement(Q,{key:n.key,title:r.a.createElement("span",null,r.a.createElement(y.a,{type:n.icon}),r.a.createElement("span",null,n.title))},a.getMenuNodes(n.children)))):(n.key!==t&&0!==t.indexOf(n.key)||a.props.setHeaderTitle(n.title),e.push(r.a.createElement(g.a.Item,{key:n.key},r.a.createElement(p.b,{to:n.key,onClick:function(){return a.props.setHeaderTitle(n.title)}},r.a.createElement(y.a,{type:n.icon}),r.a.createElement("span",null,n.title))))));return e}),[])},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.menuNodes=this.getMenuNodes(b)}},{key:"render",value:function(){var e=this.props.location.pathname,t=this.openKey;return 0===e.indexOf("/product")&&(e="/product"),r.a.createElement("div",{className:"left-nav"},r.a.createElement(p.b,{to:"/",className:"left-nav-header"},r.a.createElement("h1",{style:{marginLeft:"30px"}},"React\u540e\u53f0")),r.a.createElement(g.a,{mode:"inline",theme:"dark",selectedKeys:[e],defaultOpenKeys:[t]},this.menuNodes))}}]),t}(r.a.Component),$=Object(v.b)((function(e){return{}}),{setHeaderTitle:function(e){return{type:"set_head_title",data:e}}})(Object(d.g)(Z)),ee=(a(183),a(71));a(668);function te(e){if(!e)return"";var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}a(669);function ae(e){return r.a.createElement("button",Object.assign({},e,{className:"link-button"}))}var ne=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={currentTime:te(Date.now()),dayPictureUrl:"",weather:""},a.getTime=function(){a.intervalId=setInterval((function(){var e=te(Date.now());a.setState({currentTime:e})}),1e3)},a.getWeather=Object(k.a)(O.a.mark((function e(){var t,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A("\u897f\u5b89");case 2:t=e.sent,n=t.dayPictureUrl,r=t.weather,a.setState({dayPictureUrl:n,weather:r});case 6:case"end":return e.stop()}}),e)}))),a.getTitle=function(){var e,t=a.props.location.pathname;return b.forEach((function(a){if(a.key===t)e=a.title;else if(a.children){var n=a.children.find((function(e){return 0===t.indexOf(e.key)}));n&&(e=n.title)}})),e},a.Logout=function(){ee.a.confirm({content:"\u786e\u5b9a\u9000\u51fa\u5417\uff1f",onOk:function(){console.log("OK"),J(),f.user={},a.props.history.replace("/login")}})},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.getTime(),this.getWeather()}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){var e=this.state,t=e.currentTime,a=e.dayPictureUrl,n=e.weather,c=f.user.username,o=this.props.headTitle;return r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header-top"},r.a.createElement("span",null,"\u6b22\u8fce\uff0c",c),r.a.createElement(ae,{onClick:this.Logout},"\u9000\u51fa")),r.a.createElement("div",{className:"header-bottom"},r.a.createElement("div",{className:"header-bottom-left"},o),r.a.createElement("div",{className:"header-bottom-right"},r.a.createElement("span",null,t),r.a.createElement("img",{alt:"daypicture",src:a}),r.a.createElement("span",null,n))))}}]),t}(r.a.Component),re=Object(v.b)((function(e){return{headTitle:e.headTitle}}),{})(Object(d.g)(ne)),ce=(a(670),a(178)),oe=(a(98),a(41)),le=(a(675),a(272)),se=(a(1266),a(563)),ie=a(26),ue=a.n(ie),me=a(68),pe=a(544),de=a.n(pe),he=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=(new de.a).createView().source([{month:"Jan",a:7,b:3.9,c:5.9},{month:"Feb",a:6.9,b:4.2,c:1.9},{month:"Mar",a:9.5,b:5.7,c:3.9},{month:"Apr",a:14.5,b:8.5,c:5.5},{month:"May",a:18.4,b:11.9,c:8.9},{month:"Jun",a:21.5,b:15.2,c:10},{month:"Jul",a:25.2,b:17,c:12.9},{month:"Aug",a:26.5,b:16.6,c:15.9},{month:"Sep",a:23.3,b:14.2,c:20.7},{month:"Oct",a:18.3,b:10.3,c:25.9},{month:"Nov",a:13.9,b:6.6,c:30.9},{month:"Dec",a:9.6,b:4.8,c:35.9}]);e.transform({type:"fold",fields:["a","b","c"],key:"city",value:"temperature"});return r.a.createElement("div",{style:{float:"right",width:750,height:300}},r.a.createElement(me.Chart,{height:250,data:e,scale:{month:{range:[0,1]}},forceFit:!0},r.a.createElement(me.Legend,null),r.a.createElement(me.Axis,{name:"month"}),r.a.createElement(me.Axis,{name:"temperature",label:{formatter:function(e){return"".concat(e,"\u4e07\u4e2a")}}}),r.a.createElement(me.Tooltip,{crosshairs:{type:"y"}}),r.a.createElement(me.Geom,{type:"line",position:"month*temperature",size:2,color:"city",shape:"smooth"}),r.a.createElement(me.Geom,{type:"point",position:"month*temperature",size:4,shape:"circle",color:"city",style:{stroke:"#fff",lineWidth:1}})))}}]),t}(r.a.Component),fe=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{width:"100%",marginLeft:-30}},r.a.createElement(me.Chart,{height:338,data:[{year:"1\u6708",sales:38},{year:"2\u6708",sales:52},{year:"3\u6708",sales:61},{year:"4\u6708",sales:145},{year:"5\u6708",sales:48},{year:"6\u6708",sales:38},{year:"7\u6708",sales:28},{year:"8\u6708",sales:38},{year:"59\u6708",sales:68},{year:"10\u6708",sales:38},{year:"11\u6708",sales:58},{year:"12\u6708",sales:38}],scale:{sales:{tickInterval:20}},forceFit:!0},r.a.createElement(me.Axis,{name:"year"}),r.a.createElement(me.Axis,{name:"sales"}),r.a.createElement(me.Tooltip,{crosshairs:{type:"y"}}),r.a.createElement(me.Geom,{type:"interval",position:"year*sales"})))}}]),t}(r.a.Component),ye=(a(681),se.a.RangePicker),ge=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isVisited:!0},a.handleChange=function(e){return function(){return a.setState({isVisited:e})}},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.isVisited;return r.a.createElement("div",{className:"home"},r.a.createElement(oe.a,{className:"home-card",title:"\u5546\u54c1\u603b\u91cf",extra:r.a.createElement(y.a,{style:{color:"rgba(0,0,0,.45)"},type:"question-circle"}),style:{width:250},headStyle:{color:"rgba(0,0,0,.45)"}},r.a.createElement(le.a,{value:1128163,suffix:"\u4e2a",style:{fontWeight:"bolder"}}),r.a.createElement(le.a,{value:15,valueStyle:{fontSize:15},prefix:"\u5468\u540c\u6bd4",suffix:r.a.createElement("div",null,"%",r.a.createElement(y.a,{style:{color:"red",marginLeft:10},type:"arrow-down"}))}),r.a.createElement(le.a,{value:10,valueStyle:{fontSize:15},prefix:"\u65e5\u540c\u6bd4",suffix:r.a.createElement("div",null,"%",r.a.createElement(y.a,{style:{color:"#3f8600",marginLeft:10},type:"arrow-up"}))})),r.a.createElement(he,null),r.a.createElement(oe.a,{className:"home-content",title:r.a.createElement("div",{className:"home-menu"},r.a.createElement("span",{className:e?"home-menu-active home-menu-visited":"home-menu-visited",onClick:this.handleChange(!0)},"\u8bbf\u95ee\u91cf"),r.a.createElement("span",{className:e?"":"home-menu-active",onClick:this.handleChange(!1)},"\u9500\u552e\u91cf")),extra:r.a.createElement(ye,{defaultValue:[ue()("2019/01/01","YYYY/MM/DD"),ue()("2019/06/01","YYYY/MM/DD")],format:"YYYY/MM/DD"})},r.a.createElement(oe.a,{className:"home-table-left",title:e?"\u8bbf\u95ee\u8d8b\u52bf":"\u9500\u552e\u8d8b\u52bf",bodyStyle:{padding:0,height:275},extra:r.a.createElement(y.a,{type:"reload"})},r.a.createElement(fe,null)),r.a.createElement(oe.a,{title:"\u4efb\u52a1",extra:r.a.createElement(y.a,{type:"reload"}),className:"home-table-right"},r.a.createElement(ce.a,null,r.a.createElement(ce.a.Item,{color:"green"},"\u65b0\u7248\u672c\u8fed\u4ee3\u4f1a"),r.a.createElement(ce.a.Item,{color:"green"},"\u5b8c\u6210\u7f51\u7ad9\u8bbe\u8ba1\u521d\u7248"),r.a.createElement(ce.a.Item,{color:"red"},r.a.createElement("p",null,"\u8054\u8c03\u63a5\u53e3"),r.a.createElement("p",null,"\u529f\u80fd\u9a8c\u6536")),r.a.createElement(ce.a.Item,null,r.a.createElement("p",null,"\u767b\u5f55\u529f\u80fd\u8bbe\u8ba1"),r.a.createElement("p",null,"\u6743\u9650\u9a8c\u8bc1"),r.a.createElement("p",null,"\u9875\u9762\u6392\u7248"))))))}}]),t}(n.Component),be=(a(253),a(122)),ve=(a(84),a(32)),Ee=(a(707),a(92),a(45)),Oe=(a(218),a(67)),ke=(a(132),a(37)),we=ke.a.Item,je=Oe.a.Option,Ce=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){console.log(222),console.log(this.props.form),this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props,a=t.categorys,n=t.parentId;return r.a.createElement(ke.a,null,r.a.createElement(we,null,e("parentId",{initialValue:n})(r.a.createElement(Oe.a,null,r.a.createElement(je,{value:"0"},"\u4e00\u7ea7\u5206\u7c7b"),a.map((function(e){return r.a.createElement(je,{value:e._id},e.name)}))))),r.a.createElement(we,null,e("categoryName",{initialValue:""})(r.a.createElement(Ee.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))))}}]),t}(r.a.Component),Se=ke.a.create()(Ce),xe=ke.a.Item,Ne=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){console.log(222),console.log(this.props.form),this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.categoryName,t=this.props.form.getFieldDecorator;return r.a.createElement(ke.a,null,r.a.createElement(xe,null,t("categoryName",{initialValue:e,rules:[{required:!0,message:"\u4e0d\u80fd\u4e3a\u63a7"}]})(r.a.createElement(Ee.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"}))))}}]),t}(r.a.Component),Ie=ke.a.create()(Ne),_e=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={categorys:[],loading:!1,parentId:"0",parentName:"",subCategorys:[],showStatus:0},a.initColumns=function(){a.columns=[{title:"\u5206\u7c7b\u540d\u79f0",dataIndex:"name",key:"name"},{title:"\u64cd\u4f5c",width:300,dataIndex:"",key:"x",render:function(e){return r.a.createElement("span",null,r.a.createElement(ae,{onClick:function(){return a.showUpdate(e)}},"\u4fee\u6539\u5206\u7c7b"),"0"===a.state.parentId?r.a.createElement(ae,{onClick:function(){return a.showSubCategorys(e)}},"\u67e5\u770b\u5b50\u5206\u7c7b"):null)}}]},a.showSubCategorys=function(e){a.setState({parentId:e._id,parentName:e.name},(function(){a.getCategorys()}))},a.showCategorys=function(){a.setState({parentId:"0",parentName:"",subCategorys:[]},(function(){console.log(a.state)}))},a.getCategorys=Object(k.a)(O.a.mark((function e(){var t,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),t=a.state.parentId,e.next=4,P(t);case 4:n=e.sent,a.setState({loading:!1}),"0"==n.data.status?(r=n.data.data,console.log(r),"0"===t?a.setState({categorys:r}):a.setState({subCategorys:r})):j.a.error("\u83b7\u53d6\u5206\u7c7b\u5931\u8d25");case 7:case"end":return e.stop()}}),e)}))),a.showAdd=function(){a.setState({showStatus:1})},a.showUpdate=function(e){a.category=e,a.setState({showStatus:2})},a.addCategory=Object(k.a)(O.a.mark((function e(){var t,n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({showStatus:0}),t=a.form.getFieldsValue(),n=t.parentId,r=t.categoryName,a.form.resetFields(),e.next=5,M(r,n);case 5:0===e.sent.data.status&&a.getCategorys();case 7:case"end":return e.stop()}}),e)}))),a.updateCategory=function(){a.form.validateFields(function(){var e=Object(k.a)(O.a.mark((function e(t,n){var r,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=12;break}return a.setState({showStatus:0}),r=a.category._id,c=n.categoryName,a.form.resetFields(),console.log(111111),console.log(r),console.log(c),e.next=10,F(r,c);case 10:e.sent,a.getCategorys();case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.handleCancel=function(){a.form.resetFields(),a.setState({showStatus:0})},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getCategorys()}},{key:"render",value:function(){var e=this,t=this.state,a=t.categorys,n=t.loading,c=t.subCategorys,o=t.parentId,l=t.parentName,s=this.columns,i=this.category||{},u=0===o?"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868":r.a.createElement("span",null,r.a.createElement(ae,{onClick:this.showCategorys},"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868"),r.a.createElement(y.a,{type:"arrow-right"}),r.a.createElement("span",null,l)),m=r.a.createElement(ve.a,{type:"primary",onClick:this.showAdd},r.a.createElement(y.a,{type:"plus"}),"\u6dfb\u52a0");return r.a.createElement(oe.a,{title:u,extra:m},r.a.createElement(be.a,{rowKey:"_id",bordered:!0,dataSource:"0"===o?a:c,columns:s,pagination:{defaultPageSize:5},loading:n}),r.a.createElement(ee.a,{title:"\u6dfb\u52a0\u5206\u7c7b",visible:1===this.state.showStatus,onOk:this.addCategory,onCancel:this.handleCancel},r.a.createElement(Se,{categorys:a,parentId:o,setForm:function(t){e.form=t}})),r.a.createElement(ee.a,{title:"\u66f4\u65b0\u5206\u7c7b",visible:2===this.state.showStatus,onOk:this.updateCategory,onCancel:this.handleCancel},r.a.createElement(Ie,{categoryName:i.name,setForm:function(t){e.form=t}})))}}]),t}(r.a.Component),Te=a(206),Ae=ke.a.Item,Pe=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement(ke.a,{labelCol:{span:4},wrapperCol:{span:15}},r.a.createElement(Ae,null,e("roleName",{initialValue:"",rules:[{required:!0,message:"\u89d2\u8272\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(Ee.a,{placeholder:"\u6e05\u8f93\u5165\u89d2\u8272\u540d\u79f0"}))))}}]),t}(r.a.Component),Me=ke.a.create()(Pe),Fe=(a(822),a(360)),De=ke.a.Item,Ue=Fe.a.TreeNode,Le=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).getTreeNodes=function(e){return e.reduce((function(e,t){return e.push(r.a.createElement(Ue,{title:t.title,key:t.key},t.children?a.getTreeNodes(t.children):null)),e}),[])},a.onCheck=function(e){a.setState({checkedKeys:e})},a.getMenus=function(){return a.state.checkedKeys};var n=a.props.role.menus;return console.log(n),a.state={checkedKeys:n},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.treeNodes=this.getTreeNodes(b)}},{key:"render",value:function(){var e=this.props.role,t=this.state.checkedKeys;return r.a.createElement("div",null,r.a.createElement(De,Object.assign({label:"\u89d2\u8272\u540d\u79f0"},{labelCol:{span:4},wrapperCol:{span:15}}),r.a.createElement(Ee.a,{value:e.name,disabled:!0})),r.a.createElement(Fe.a,{checkable:!0,defaultExpandAll:!0,checkedKeys:t,onCheck:this.onCheck},r.a.createElement(Ue,{title:"\u5e73\u53f0\u6743\u9650",key:"all"},this.treeNodes)))}}]),t}(r.a.Component),Re=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={roles:[{menus:["/home","/products","/category","/product","/role"],_id:"5ca9eac0",name:"\u89d2\u82721",create_time:1554639552758,_v:0,auth_time:1557630307021,auth_name:"admim"}],loading:!1,role:{},isShowAdd:!1,isShowAuth:!1},a.initColumn=function(){a.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:function(e){return te(e)}},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",render:te},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"}]},a.addRole=function(){a.form.validateFields(function(){var e=Object(k.a)(O.a.mark((function e(t,n){var r,c,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=8;break}return a.setState({isShowAdd:!1}),r=n.roleName,a.form.resetFields(),e.next=6,T(r);case 6:0===(c=e.sent).status?(j.a.success("\u6dfb\u52a0\u9648\u5bab"),o=c.data,a.setState((function(e){return{roles:[].concat(Object(Te.a)(e.roles),[o])}}))):j.a.error("\u6dfb\u52a0\u5931\u8d25");case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.updateRole=Object(k.a)(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({isShowAuth:!0}),t=a.state.role,n=a.auth.current.getMenus,t.menus=n,t.auth_name=f.user.username,t.auth_time=Date.now(),e.next=8,z(t);case 8:0===e.sent.state?(j.a.success("\u8bbe\u7f6e\u89d2\u8272\u6743\u9650\u6210\u529f"),t._id==f.user.role._id&&(f.user={},J(),a.props.history.replace("/login")),a.setState({roles:Object(Te.a)(a.state.roles)})):j.a.error("\u8bbe\u7f6e\u89d2\u8272\u5931\u8d25");case 10:case"end":return e.stop()}}),e)}))),a.handleCancel=function(){a.setState({isShowAdd:!1}),a.form.resetFields()},a.handleCancelAuth=function(){a.setState({isShowAuth:!1})},a.onRow=function(e){return{onClick:function(t){a.setState({role:e})}}},a.auth=r.a.createRef(),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.initColumn()}},{key:"render",value:function(){var e=this,t=this.state,a=t.roles,n=t.loading,c=t.role,o=t.isShowAdd,l=t.isShowAuth,s=r.a.createElement("span",null,r.a.createElement(ve.a,{type:"primary",onClick:function(){return e.setState({isShowAdd:!0})}},"\u521b\u5efa\u89d2\u8272"),"\xa0\xa0",r.a.createElement(ve.a,{type:"primary",disabled:!c._id,onClick:function(){return e.setState({isShowAuth:!0})}},"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650")),i={type:"radio",selectedRowKeys:[c._id],onSelect:function(t){e.setState({role:t})}};return r.a.createElement(oe.a,{title:s},r.a.createElement(be.a,{bordered:!0,rowKey:"_id",loadding:n,dataSource:a,columns:this.columns,pagination:{defaultPageSize:5},rowSelection:i,onRow:this.onRow}),r.a.createElement(ee.a,{title:"\u6dfb\u52a0\u89d2\u8272",visible:o,onOk:this.addRole,onCancel:this.handleCancel},r.a.createElement(Me,{setForm:function(t){e.form=t}})),r.a.createElement(ee.a,{title:"\u8bbe\u7f6e\u6743\u9650",visible:l,onOk:this.updateRole,onCancel:this.handleCancelAuth},r.a.createElement(Le,{ref:this.auth,role:c})))}}]),t}(r.a.Component),Ve=ke.a.Item,We=Oe.a.Option,ze=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.props.setForm(this.props.form)}},{key:"render",value:function(){var e=this.props.roles,t=this.props.user||{},a=this.props.form.getFieldDecorator;return r.a.createElement(ke.a,{labelCol:{span:4},wrapperCol:{span:15}},r.a.createElement(Ve,{label:"\u7528\u6237\u540d"},a("username",{initialValue:t.username,rules:[{required:!0,message:"\u89d2\u8272\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(Ee.a,{placeholder:"\u6e05\u8f93\u5165\u89d2\u8272\u540d\u79f0"}))),t._id?null:r.a.createElement(Ve,{label:"\u5bc6\u7801"},a("password",{initialValue:t.password,rules:[{required:!0,message:"\u5bc6\u7801\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(Ee.a,{type:"password",placeholder:"\u6e05\u8f93\u5165\u5bc6\u7801"}))),r.a.createElement(Ve,{label:"\u624b\u673a\u53f7"},a("phone",{initialValue:t.phone,rules:[{required:!0,message:"\u624b\u673a\u53f7\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(Ee.a,{placeholder:"\u6e05\u8f93\u5165\u624b\u673a\u53f7"}))),r.a.createElement(Ve,{label:"\u90ae\u7bb1"},a("email",{initialValue:t.email,rules:[{required:!0,message:"\u90ae\u7bb1\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(Ee.a,{placeholder:"\u6e05\u8f93\u5165\u90ae\u7bb1"}))),r.a.createElement(Ve,{label:"\u89d2\u8272"},a("role_id",{initialValue:t.role_id,rules:[{required:!0,message:"\u89d2\u8272\u5fc5\u987b\u8f93\u5165"}]})(r.a.createElement(Oe.a,null,e.map((function(e){return r.a.createElement(We,{key:e._id,value:e._id},e.name)}))))))}}]),t}(r.a.PureComponent),Ke=ke.a.create()(ze),qe=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={loading:!1,users:[{username:"text",_id:"548542421",create_time:1554639552758,email:"test@aadfa.conm",phone:"15712548",role_id:"fdsa854854",password:"12312312"}],roles:[{_id:"fdsa854854",name:"\u6d4b\u8bd5"}],isShow:!1},a.initColumn=function(){a.columns=[{title:"\u7528\u6237\u660e",dataIndex:"username"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u7535\u8bdd",dataIndex:"phone"},{title:"\u6ce8\u518c\u65f6\u95f4",dataIndex:"create_time",render:te},{title:"\u6240\u5c5e\u89d2\u8272",dataIndex:"role_id",render:function(e){return a.state.roles.find((function(t){return t._id===e})).name}},{title:"\u64cd\u4f5c",render:function(e){return r.a.createElement("span",null,r.a.createElement(ae,{onClick:function(){return a.showUpdate(e)}},"\u4fee\u6539"),r.a.createElement(ae,{onClick:function(){return a.deleteUser(e)}},"\u5220\u9664"))}}]},a.showUpdate=function(e){a.user=e,a.setState({isShow:!0})},a.showAdd=function(){a.user=null,a.setState({isShow:!0})},a.addOrUpdateUser=Object(k.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({isshow:!1}),t=a.form.getFieldsValue(),a.form.resetFields(),e.next=5,T(t);case 5:0===e.sent.static&&(j.a.success("\u6dfb\u52a0\u6210\u529f"),a.getUsers());case 7:case"end":return e.stop()}}),e)}))),a.deleteUser=function(e){ee.a.confirm({title:"\u786e\u5b9a\u8981\u5220\u9664\u7528\u6237"+e.username+"?",onOk:function(){var t=Object(k.a)(O.a.mark((function t(){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q(e._id);case 2:0===t.sent.status&&(j.a.success("\u5220\u9664\u7528\u6237\u6210\u529f"),a.getUsers());case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()})},a.initRoleNames=function(e){var t=e.reduce((function(e,t){return e[t._id]=t.name,e}),[]);a.roleNames=t},a.getUsers=Object(k.a)(O.a.mark((function e(){var t,n,r,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K();case 2:0===(t=e.sent).status&&(n=t.data,r=n.users,c=n.roles,a.initRoleNames(c),a.setState({users:r,roles:c}));case 4:case"end":return e.stop()}}),e)}))),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.initColumn(),this.getUsers()}},{key:"render",value:function(){var e=this,t=r.a.createElement(ve.a,{type:"primary",onClick:function(){return e.showAdd()}},"\u521b\u5efa\u7528\u6237"),a=this.state,n=a.loading,c=a.users,o=a.isShow,l=a.roles,s=this.user;return r.a.createElement(oe.a,{title:t},r.a.createElement(be.a,{bordered:!0,rowKey:"_id",loadding:n,dataSource:c,pagination:{defaultPageSize:5},columns:this.columns}),r.a.createElement(ee.a,{title:s?"\u4fee\u6539\u7528\u6237":"\u6dfb\u52a0\u7528\u6237",visible:o,onOk:this.addOrUpdateUser,onCancel:function(){e.form.resetFields(),e.setState({isShow:!1})}},r.a.createElement(Ke,{user:s,setForm:function(t){return e.form=t},roles:l},"1111")))}}]),t}(r.a.Component),Ye=a(149),Be=a.n(Ye),He=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={sales:[5,20,36,10,10,20]},a.update=function(){a.setState((function(e){return{sales:e.sales.map((function(e){return e+1}))}}))},a.getOption=function(e,t){return{title:{text:"Echarts \u5165\u95e8"},tooltip:{},legend:{data:["\u9500\u91cf"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u4f1e","\u96ea\u7eba\u88e4","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"bar",data:e}]}},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.sales;return r.a.createElement("div",null,r.a.createElement(oe.a,null,r.a.createElement(ve.a,{type:"primary",onClick:this.update},"\u66f4\u65b0")),r.a.createElement(oe.a,{title:"\u67f1\u72b6\u56fe--\x3e"},r.a.createElement(Be.a,{option:this.getOption(e)})))}}]),t}(r.a.Component),Ge=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={sales:[5,20,36,10,10,20]},a.update=function(){a.setState((function(e){return{sales:e.sales.map((function(e){return e+1}))}}))},a.getOption=function(e){return{title:{text:"Echarts \u5165\u95e8"},tooltip:{},legend:{data:["\u9500\u91cf"]},xAxis:{data:["\u886c\u886b","\u7f8a\u6bdb\u4f1e","\u96ea\u7eba\u88e4","\u88e4\u5b50","\u9ad8\u8ddf\u978b","\u889c\u5b50"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"line",data:e}]}},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.sales;return r.a.createElement("div",null,r.a.createElement(oe.a,null,r.a.createElement(ve.a,{type:"primary",onClick:this.update},"\u66f4\u65b0")),r.a.createElement(oe.a,{title:"\u6298\u7ebf\u56fe--\x3e"},r.a.createElement(Be.a,{option:this.getOption(e)})))}}]),t}(r.a.Component),Je=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).getOption=function(){return{title:{text:"\u67d0\u7ad9\u70b9\u7528\u6237\u8bbf\u95ee\u6765\u6e90",subtext:"\u7eaf\u5c5e\u865a\u6784",x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:["\u76f4\u63a5\u8bbf\u95ee","\u90ae\u4ef6\u8425\u9500","\u8054\u76df\u5e7f\u544a","\u89c6\u9891\u5e7f\u544a","\u641c\u7d22\u5f15\u64ce"]},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:234,name:"\u8054\u76df\u5e7f\u544a"},{value:135,name:"\u89c6\u9891\u5e7f\u544a"},{value:1548,name:"\u641c\u7d22\u5f15\u64ce"}],itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},a.getOption2=function(){return{backgroundColor:"#2c343c",title:{text:"Customized Pie",left:"center",top:20,textStyle:{color:"#ccc"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},visualMap:{show:!1,min:80,max:600,inRange:{colorLightness:[0,1]}},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","50%"],data:[{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:274,name:"\u8054\u76df\u5e7f\u544a"},{value:235,name:"\u89c6\u9891\u5e7f\u544a"},{value:400,name:"\u641c\u7d22\u5f15\u64ce"}].sort((function(e,t){return e.value-t.value})),roseType:"radius",label:{normal:{textStyle:{color:"rgba(255, 255, 255, 0.3)"}}},labelLine:{normal:{lineStyle:{color:"rgba(255, 255, 255, 0.3)"},smooth:.2,length:10,length2:20}},itemStyle:{normal:{color:"#c23531",shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"}},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 200*Math.random()}}]}},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(oe.a,{title:"\u997c\u56fe\u4e00"},r.a.createElement(Be.a,{option:this.getOption(),style:{height:300}})),r.a.createElement(oe.a,{title:"\u997c\u56fe\u4e8c"},r.a.createElement(Be.a,{option:this.getOption2(),style:{height:300}})))}}]),t}(n.Component),Xe=Oe.a.Option,Qe=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(c)))).state={products:[],total:0,loading:!1,searchName:"",searchType:"productName"},a.initColumns=function(){a.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name",key:"name"},{title:"\u5546\u54c1\u63cf\u8ff0",dataIndex:"desc",key:"age"},{title:"\u4ef7\u683c",dataIndex:"price",render:function(e){return"\uffe5"+e}},{width:100,title:"\u72b6\u6001",render:function(e){var t=e.status,n=e._id;return r.a.createElement("span",null,r.a.createElement(ve.a,{type:"primary",onClick:function(){return a.updateStatus(0===t?1:0,n)}},1===t?"\u4e0b\u67b6":"\u4e0a\u67b6"),r.a.createElement("span",null,1===t?"\u5728\u552e":"\u5df2\u4e0b\u67b6"))}},{width:100,title:"\u64cd\u4f5c",render:function(e){return r.a.createElement("span",null,r.a.createElement(ae,{onClick:function(){return a.props.history.push("/product/detail",e)}},"\u8be6\u60c5"),r.a.createElement(ae,{onClick:function(){return a.props.history.push("/product/addupdate",e)}},"\u4fee\u6539"))}}]},a.updateStatus=function(){var e=Object(k.a)(O.a.mark((function e(t,n){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(n,t);case 2:0===e.sent.data.status&&(j.a.success("\u66f4\u65b0\u6210\u529f"),a.getProducts(a.pageNum));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a.getProducts=function(){var e=Object(k.a)(O.a.mark((function e(t){var n,r,c,o,l,s,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.pageNum=t,a.setState({loading:!0}),n=a.state,r=n.searchName,c=n.searchType,!r){e.next=9;break}return e.next=6,U({pageNum:t,pageSize:2,searchName:r,searchType:c});case 6:o=e.sent,e.next=12;break;case 9:return e.next=11,D(t,2);case 11:o=e.sent;case 12:a.setState({loading:!1}),console.log(o.data),0===o.data.status&&(l=o.data.data,s=l.total,i=l.list,a.setState({total:s,products:i}));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getProducts(1)}},{key:"render",value:function(){var e=this,t=this.state,a=t.products,n=t.total,c=t.loading,o=t.searchName,l=t.searchType,s=r.a.createElement("span",null,r.a.createElement(Oe.a,{value:l,style:{width:150},onChange:function(t){return e.setState({searchType:t})}},r.a.createElement(Xe,{value:"productName"},"\u6309\u540d\u79f0\u641c\u7d22"),r.a.createElement(Xe,{value:"productDesc"},"\u6309\u63cf\u8ff0\u641c\u7d22")),r.a.createElement(Ee.a,{placeholder:"\u5173\u952e\u5b57",style:{width:150,margin:"0 15px"},value:o,onChange:function(t){return e.setState({searchName:t.target.value})}}),r.a.createElement(ve.a,{type:"primary",onClick:function(){return e.getProducts(1)}},"\u641c\u7d22")),i=r.a.createElement(ve.a,{type:"primary",onClick:function(){return e.props.history.push("/product/addupdate")}},r.a.createElement(y.a,{type:"plus"}),"\u6dfb\u52a0\u5546\u54c1");return r.a.createElement(oe.a,{title:s,extra:i},r.a.createElement(be.a,{bordered:!0,rowKey:"_id",loadding:c,dataSource:a,pagination:{total:n,defaultPageSize:2,onChange:this.getProducts},columns:this.columns}))}}]),t}(r.a.Component),Ze=(a(1129),a(565)),$e=a(256),et=(a(1267),a(564)),tt=a(1),at=a.n(tt);function nt(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}}))}var rt=function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).getImgs=function(){return a.state.fileList.map((function(e){return e.name}))},a.handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(){var e=Object(k.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.url||t.preview){e.next=4;break}return e.next=3,nt(t.originFileObj);case 3:t.preview=e.sent;case 4:a.setState({previewImage:t.url||t.preview,previewVisible:!0});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(){var e=Object(k.a)(O.a.mark((function e(t){var n,r,c,o,l,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file,r=t.fileList,"done"!==n.status){e.next=6;break}0===(c=n.response).status?(j.a.success("\u4e0a\u4f20\u6210\u529f"),o=c.data,l=o.name,s=o.url,(n=r[r.length-1]).name=l,n.url=s):j.a.error("\u4e0a\u4f20\u5931\u8d25"),e.next=11;break;case 6:if("removed"!==n.status){e.next=11;break}return e.next=9,V(n.name);case 9:0===e.sent.status?j.a.success("\u5220\u9664\u6210\u529f"):j.a.error("\u5220\u9664\u5931\u8d25");case 11:a.setState({fileList:r});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var n=[],r=a.props.imgs;return r&&r.length>0&&(n=r.map((function(e,t){return{uid:-t,name:e,status:"done",url:"http://localhost:3000/static/media/"+e}}))),console.log(1111),console.log(n),a.state={previewVisible:!1,previewImage:"",fileList:n},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state,t=e.previewVisible,a=e.previewImage,n=e.fileList,c=r.a.createElement("div",null,r.a.createElement(y.a,{type:"plus"}),r.a.createElement("div",{className:"ant-upload-text"},"Upload"));return r.a.createElement("div",null,r.a.createElement(et.a,{accept:"image/*",action:"/users/upload",listType:"picture-card",fileList:n,name:"image",onPreview:this.handlePreview,onChange:this.handleChange},n.length>=3?null:c),r.a.createElement(ee.a,{visible:t,footer:null,onCancel:this.handleCancel},r.a.createElement("img",{alt:"example",style:{width:"100%"},src:a})))}}]),t}(r.a.Component);rt.protypes={imgs:at.a.array};var ct=a(125),ot=a(555),lt=a(556),st=a.n(lt),it=a(557),ut=a.n(it),mt=(a(1260),function(e){function t(e){var a;Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={editorState:ct.EditorState.createEmpty()},a.uploadImageCallback=function(e){return new Promise((function(t,a){var n=new XMLHttpRequest;n.open("POST","/users/uploadimg");var r=new FormData;r.append("image",e),n.send(r),n.addEventListener("load",(function(){var e=JSON.parse(n.responseText).data.url;t({data:{link:e}})})),n.addEventListener("error",(function(){var e=JSON.parse(n.responseText);a(e)}))}))},a.getDetail=function(){return st()(Object(ct.convertToRaw)(a.state.editorState.getCurrentContent()))},a.onEditorStateChange=function(e){a.setState({editorState:e})};var n=a.props.detail;if(n){var r=ut()(n),c=ct.ContentState.createFromBlockArray(r.contentBlocks),o=ct.EditorState.createWithContent(c);a.state={editorState:o}}else a.state={editorState:ct.EditorState.createEmpty()};return a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.state.editorState;return r.a.createElement(ot.Editor,{editorState:e,editorStyle:{border:"1px solid black",minHeight:200,paddingLeft:10},onEditorStateChange:this.onEditorStateChange,toolbar:{image:{uploadCallback:this.uploadImageCallback,alt:{present:!0,mandatory:!0}}}})}}]),t}(n.Component)),pt=ke.a.Item,dt=Ee.a.TextArea,ht=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this))).state={options:[]},a.submit=function(){a.props.form.validateFields(function(){var e=Object(k.a)(O.a.mark((function e(t,n){var r,c,o,l,s,i,u,m,p;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=11;break}return r=n.name,c=n.desc,o=n.price,1===(l=n.categoryIds).length?(s="0",i=l[0]):(s=l[0],i=l[1]),u=a.pw.current.getImgs(),m=a.editor.current.getDetail(),p={name:r,desc:c,price:o,imgs:u,detail:m,pCategoryId:s,categoryId:i},a.isUpdate&&(p._id=a.product._id),e.next=9,W(p);case 9:0===e.sent.status?(j.a.success("".concat(a.isUpdate,"? '\u66f4\u65b0:'\u6dfb\u52a0'\u5546\u54c1\u6210\u529f!")),a.props.history.goBack()):j.a.error("".concat(a.isUpdate,"? '\u66f4\u65b0:'\u6dfb\u52a0'\u5546\u54c1\u5931\u8d25!"));case 11:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.validattorPrice=function(e,t,a){1*t>0?a():a("\u4ef7\u683c\u683c\u5f0f\u4e0d\u5bf9")},a.getCategory=function(){var e=Object(k.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t);case 2:if(n=e.sent,console.log(n.data.status),"0"!==n.data.status){e.next=11;break}if(r=n.data.data,"0"!==t){e.next=10;break}a.initOptions(r),e.next=11;break;case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.initOptions=function(){var e=Object(k.a)(O.a.mark((function e(t){var n,r,c,o,l,s,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.map((function(e){return{value:e._id,label:e.name,isLeaf:!1}})),r=Object($e.a)(a),c=r.isUpdate,o=r.product,l=o.pCategoryId,o.categoryId,!c||"0"===l){e.next=10;break}return e.next=6,a.getCategory(l);case 6:s=e.sent,i=s.map((function(e){return{value:e._id,label:e.name,isLeaf:!1}})),n.find((function(e){return e.value==l})).children=i;case 10:console.log(n),a.setState({options:n});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.loadData=function(){var e=Object(k.a)(O.a.mark((function e(t){var n,r,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t[0]).loading=!0,e.next=4,a.getCategory(n.value);case 4:r=e.sent,n.loading=!1,r&&r.length>0?(c=r.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),n.children=c):n.isLeaf=!0,a.setState({options:Object(Te.a)(a.state.options)});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.pw=r.a.createRef(),a.editor=r.a.createRef(),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.getCategory("0")}},{key:"componentWillMount",value:function(){var e=this.props.location.state;this.isUpdate=!!e,this.product=e||{}}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.isUpdate,n=this.product,c=n.pCategoryId,o=n.categoryId,l=n.imgs,s=n.detail,i=[];a&&("0"===c?i.push(o):(i.push(c),i.push(o)));var u=r.a.createElement("span",null,r.a.createElement(ae,{onClick:function(){return e.props.history.goBack()}},r.a.createElement(y.a,{type:"arrow-left",style:{fontSize:20}})),r.a.createElement("span",null,a?"\u4fee\u6539\u5546\u54c1":"\u6dfb\u52a0\u5546\u54c1"));return r.a.createElement(oe.a,{title:u},r.a.createElement(ke.a,{labelCol:{span:2},wrapperCol:{span:8}},r.a.createElement(pt,{label:"\u5546\u54c1\u540d\u79f0:"},t("name",{initialValue:n.name,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}]})(r.a.createElement(Ee.a,{placeholder:"\u5546\u54c1\u540d\u79f0"}))),r.a.createElement(pt,{label:"\u5546\u54c1\u63cf\u8ff0:"},t("desc",{initialValue:n.desc,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0"}]})(r.a.createElement(dt,{placeholder:"\u5546\u54c1\u63cf\u8ff0",autoSize:{minRows:2}}))),r.a.createElement(pt,{label:"\u5546\u54c1\u4ef7\u683c:"},t("price",{initialValue:n.price,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0"},{validator:this.validattorPrice}]})(r.a.createElement(Ee.a,{type:"number",addonAfter:"\u5143",placeholder:"\u5546\u54c1\u4ef7\u683c"}))),r.a.createElement(pt,{label:"\u5546\u54c1\u5206\u7c7b:"},r.a.createElement("div",null,"\u5546\u54c1\u5206\u7c7b")),r.a.createElement(pt,{label:"\u5546\u54c1\u5206\u7c7b:"},t("categoryIds",{initialValue:i,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u5206\u7c7b"}]})(r.a.createElement(Ze.a,{options:this.state.options,loadData:this.loadData,onChange:this.onChange,changeOnSelect:!0}))),r.a.createElement(pt,{label:"\u5546\u54c1\u56fe\u7247:"},r.a.createElement(rt,{ref:this.pw,imgs:l})),r.a.createElement(pt,{label:"\u5546\u54c1\u8be6\u60c5:",labelCol:{span:2},wrapperCol:{span:20}},r.a.createElement(mt,{ref:this.editor,detail:s})),r.a.createElement(pt,null,r.a.createElement(ve.a,{type:"primary",onClick:this.submit},"\u63d0\u4ea4"))))}}]),t}(r.a.Component),ft=ke.a.create()(ht),yt=(a(1261),a(361)),gt=yt.a.Item,bt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={cName1:"",cName2:""},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"getCategoryInfo",value:function(){}},{key:"componentDidMount",value:function(){var e=Object(k.a)(O.a.mark((function e(){var t,a,n,r,c,o,l,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.location.state,a=t.pCategoryId,n=t.categoryId,0!==a){e.next=9;break}return e.next=4,L(n);case 4:r=e.sent,c=r.data.data.name,this.setState({cName1:c}),e.next=15;break;case 9:return e.next=11,Promise.all([L(n),L(a)]);case 11:o=e.sent,l=o[0].data.data.name,s=o[1].data.data.name,this.setState({cName1:l,cName2:s});case 15:this.getCategoryInfo();case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.location.state,a=t.name,n=t.desc,c=t.price,o=t.detail,l=t.imgs,s=this.state,i=s.cName1,u=s.cName2,m=r.a.createElement("span",null,r.a.createElement(ae,null,r.a.createElement(y.a,{type:"arrow-left",style:{color:"green",marginRight:10,fontSize:20},onClick:function(){return e.props.history.goBack()}})),r.a.createElement("span",null,"\u5546\u54c1\u5fc3\u60c5"));return r.a.createElement(oe.a,{title:m,className:"product-detail"},r.a.createElement(yt.a,null,r.a.createElement(gt,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u540d\u79f0:"),r.a.createElement("span",null,a)),r.a.createElement(gt,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u63cf\u8ff0:"),r.a.createElement("span",null,n)),r.a.createElement(gt,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u4ef7\u683c:"),r.a.createElement("span",null,c)),r.a.createElement(gt,null,r.a.createElement("span",{className:"left"},"\u6240\u5c5e\u5206\u7c7b:"),r.a.createElement("span",null,i,"-",u?"--\x3e"+u:"")),r.a.createElement(gt,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u56fe\u7247:"),r.a.createElement("span",null,l.map((function(e){return r.a.createElement("img",{key:e+Math.random(),className:"product-img",src:"http://localhost:3000/static/media/"+e,alt:"img"})})))),r.a.createElement(gt,null,r.a.createElement("span",{className:"left"},"\u5546\u54c1\u8be6\u60c5:"),r.a.createElement("span",{dangerouslySetInnerHTML:{__html:o}}))))}}]),t}(r.a.Component),vt=(a(1263),function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/product",component:Qe}),r.a.createElement(d.b,{path:"/product/addupdate",component:ft}),r.a.createElement(d.b,{path:"/product/detail",component:bt}),r.a.createElement(d.a,{to:"/product"}))}}]),t}(r.a.Component)),Et=h.a.Footer,Ot=h.a.Sider,kt=h.a.Content,wt=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=f.user;return console.log(e),e&&e.username?r.a.createElement(h.a,{style:{minHeight:"100%"}},r.a.createElement(Ot,null,r.a.createElement($,null)),r.a.createElement(h.a,null,r.a.createElement(re,null,"Header"),r.a.createElement(kt,{style:{margin:"20px",backgroundColor:"#fff"}},r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/home",component:ge}),r.a.createElement(d.b,{path:"/category",component:_e}),r.a.createElement(d.b,{path:"/product",component:vt}),r.a.createElement(d.b,{path:"/role",component:Re}),r.a.createElement(d.b,{path:"/user",component:qe}),r.a.createElement(d.b,{path:"/charts/bar",component:He}),r.a.createElement(d.b,{path:"/charts/pie",component:Je}),r.a.createElement(d.b,{path:"/charts/line",component:Ge}),r.a.createElement(d.a,{to:"/home"}))),r.a.createElement(Et,{style:{textAlign:"center",color:"#cccccc"}},"\u63a8\u8350\u4f7f\u7528\u8c37\u6b4c\u6d4f\u89c8\u5668\uff0c\u53ef\u4ee5\u83b7\u5f97\u66f4\u4f73\u9875\u9762\u64cd\u4f5c\u4f53\u9a8c"))):r.a.createElement(d.a,{to:"/login"})}}]),t}(r.a.Component),jt=(a(390),a(124)),Ct=(a(1264),a(559)),St=a.n(Ct),xt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(){var e=Object(k.a)(O.a.mark((function e(t,n){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=9;break}return a.props.login(n.username,n.password),e.next=4,_(n.username,n.password);case 4:r=e.sent,r.data.stateus||(j.a.success("login success"),f.user={username:"crc",role:{menus:"/product"}},H({username:"crc"}),a.props.history.replace("/admin")),e.next=10;break;case 9:console.log("validate fail");case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())},a.validatorPwd=function(e,t,a){t?t.length<6?a("at least 6"):t.length>12?a("most 12"):a():a("not empty")},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.user;console.log(e);var t=this.props.form.getFieldDecorator;return r.a.createElement("div",{className:"login"},r.a.createElement("header",{className:"login-header"},r.a.createElement("img",{src:St.a,alt:"logo"}),r.a.createElement("h1",null,"React \u540e\u53f0\u7ba1\u7406\u7cfb\u7edf")),r.a.createElement("section",{className:"login-content"},r.a.createElement("h2",null,"\u7528\u6237\u767b\u5f55"),r.a.createElement("div",null,r.a.createElement(ke.a,{onSubmit:this.handleSubmit,className:"login-form"},r.a.createElement(ke.a.Item,null,t("username",{rules:[{required:!0,message:"Please input your username!"},{min:4,message:"at least 4"},{max:12,message:"most 12"}]})(r.a.createElement(Ee.a,{prefix:r.a.createElement(y.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),r.a.createElement(ke.a.Item,null,t("password",{rules:[{validator:this.validatorPwd}]})(r.a.createElement(Ee.a,{prefix:r.a.createElement(y.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),r.a.createElement(ke.a.Item,null,t("remember",{valuePropName:"checked",initialValue:!0})(r.a.createElement(jt.a,null,"Remember me")),r.a.createElement("a",{className:"login-form-forgot",href:"#"},"Forgot password"),r.a.createElement(ve.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in"),"Or ",r.a.createElement("a",{href:""},"register now!"))))))}}]),t}(r.a.Component),Nt=ke.a.create()(xt),It=Object(v.b)((function(e){return{user:e.user}}),{login:function(e,t){return function(){var a=Object(k.a)(O.a.mark((function a(n){var r,c,o;return O.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,_(e,t);case 2:0===(r=a.sent).data.status?(c=r.data.user,H(c),n(X(c))):(o=r.data.msg,n({type:"show_error_msg",errorMsg:o}));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}})(Nt),_t=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/login",component:It}),r.a.createElement(d.b,{path:"/",component:wt})))}}]),t}(r.a.Component),Tt=a(121),At=a(560);var Pt=G();var Mt=Object(Tt.combineReducers)({headTitle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u9996\u9875",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"set_head_title":return t.data;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"recerive_user":return t.user;case"show_error_msg":var a=t.errorMsg;return Object(At.a)({},e,{errorMsg:a});default:return e}}}),Ft=a(561),Dt=a(562),Ut=Object(Tt.createStore)(Mt,Object(Dt.composeWithDevTools)(Object(Tt.applyMiddleware)(Ft.a))),Lt=G();f.user=Lt,o.a.render(r.a.createElement(v.a,{store:Ut},r.a.createElement(_t,null)),document.getElementById("root"))},559:function(e,t,a){e.exports=a.p+"static/media/logo.ba1f87ec.png"},568:function(e,t,a){e.exports=a(1265)},579:function(e,t,a){},668:function(e,t,a){},669:function(e,t,a){},681:function(e,t,a){},707:function(e,t,a){}},[[568,1,2]]]);
//# sourceMappingURL=main.bdb65630.chunk.js.map