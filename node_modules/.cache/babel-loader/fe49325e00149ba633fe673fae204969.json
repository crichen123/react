{"ast":null,"code":"import \"antd/es/card/style/css\";\nimport _Card from \"antd/es/card\";\nimport \"antd/es/table/style/css\";\nimport _Table from \"antd/es/table\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/message/style/css\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/modal/style/css\";\nimport _Modal from \"antd/es/modal\";\nvar _jsxFileName = \"/home/crc/WebstormProjects/react-admin/src/pages/user/user.jsx\";\nimport React from 'react';\nimport { PAGE_SIZE } from \"../../utils/constant\";\nimport { formateDate } from \"../../utils/dateUtils\";\nimport LinkButton from \"../../components/link-button\";\nimport AddForm from \"../role/add-form\";\nimport { reqGetUsers, reqDeleUser } from \"../../api\";\nexport default class User extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      loading: false,\n      users: [{\n        \"username\": \"text\",\n        \"_id\": \"548542421\",\n        \"create_time\": 1554639552758,\n        \"email\": \"test@aadfa.conm\",\n        \"phone\": \"15712548\",\n        \"role_id\": \"fdsa854854\"\n      }],\n      roles: [],\n      isShow: false\n    };\n\n    this.initColumn = () => {\n      this.columns = [{\n        title: '用户明',\n        dataIndex: \"usernamne\"\n      }, {\n        title: \"邮箱\",\n        dataIndex: \"email\"\n      }, {\n        title: \"电话\",\n        dataIndex: \"phone\"\n      }, {\n        title: \"注册时间\",\n        dataIndex: \"create_time\",\n        render: formateDate\n      }, {\n        title: \"所属角色\",\n        dataIndex: \"role_id\",\n        // render:(role_id)=>this.state.roles.find(role=>role._id ===role_id).name\n        render: role_id => this.roleNames[role_id]\n      }, {\n        title: \"操作\",\n        render: user => React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 48\n          },\n          __self: this\n        }, React.createElement(LinkButton, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 49\n          },\n          __self: this\n        }, \"\\u4FEE\\u6539\"), React.createElement(LinkButton, {\n          onClick: () => this.deleteUser(user),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 50\n          },\n          __self: this\n        }, \"\\u5220\\u9664\"))\n      }];\n    };\n\n    this.addOrUPdateUser = () => {};\n\n    this.deleteUser = user => {\n      _Modal.confirm({\n        title: \"确定要删除用户\" + user.username + \"?\",\n        onOk: async () => {\n          const result = await reqDeleUser(user._id);\n\n          if (result.status === 0) {\n            _message.success(\"删除用户成功\");\n\n            this.getUsers();\n          }\n        }\n      });\n    };\n\n    this.initRoleNames = roles => {\n      const roleNames = roles.reduce((pre, role) => {\n        pre[role._id] = role.name;\n        return pre;\n      }, []);\n      this.roleNames = roleNames;\n    };\n\n    this.getUsers = async () => {\n      const result = await reqGetUsers();\n\n      if (result.status === 0) {\n        const {\n          users,\n          roles\n        } = result.data;\n        this.initRoleNames(roles);\n        this.setState({\n          users,\n          roles\n        });\n      }\n    };\n  }\n\n  componentDidMount() {\n    this.initColumn();\n    this.getUsers();\n  }\n\n  render() {\n    const title = React.createElement(_Button, {\n      type: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, \"\\u521B\\u5EFA\\u7528\\u6237\");\n    const {\n      loading,\n      users,\n      isShow\n    } = this.state;\n    return React.createElement(_Card, {\n      title: title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(_Table, {\n      bordered: true,\n      rowKey: \"_id\",\n      loadding: loading,\n      dataSource: users,\n      pagination: {\n        defaultPageSize: 5\n      },\n      columns: this.columns,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }), React.createElement(_Modal, {\n      title: \"\\u6DFB\\u52A0\\u7528\\u6237\",\n      visible: isShow,\n      onOk: this.addOrUPdateUser,\n      onCancel: () => this.setState({\n        isShow: false\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, \"1111\")));\n  }\n\n}","map":{"version":3,"sources":["/home/crc/WebstormProjects/react-admin/src/pages/user/user.jsx"],"names":["React","PAGE_SIZE","formateDate","LinkButton","AddForm","reqGetUsers","reqDeleUser","User","Component","state","loading","users","roles","isShow","initColumn","columns","title","dataIndex","render","role_id","roleNames","user","deleteUser","addOrUPdateUser","confirm","username","onOk","result","_id","status","success","getUsers","initRoleNames","reduce","pre","role","name","data","setState","componentDidMount","defaultPageSize"],"mappings":"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","sourcesContent":["import React from 'react'\nimport {Modal, Card, Button, Table, message} from \"antd\"\nimport {PAGE_SIZE} from \"../../utils/constant\";\nimport {formateDate} from \"../../utils/dateUtils\";\nimport LinkButton from \"../../components/link-button\";\nimport AddForm from \"../role/add-form\";\nimport {reqGetUsers,reqDeleUser} from \"../../api\"\n\nexport default class User extends React.Component {\n\n    state = {\n        loading:false,\n        users:[{\n            \"username\":\"text\",\n            \"_id\":\"548542421\",\n            \"create_time\":1554639552758,\n            \"email\":\"test@aadfa.conm\",\n            \"phone\":\"15712548\",\n            \"role_id\":\"fdsa854854\"\n        }],\n        roles:[],\n        isShow:false,\n\n    }\n\n    initColumn = ()=>{\n        this.columns = [{\n            title:'用户明',\n            dataIndex:\"usernamne\"\n        },{\n            title:\"邮箱\",\n            dataIndex: \"email\"\n        },{\n            title:\"电话\",\n            dataIndex: \"phone\"\n        },{\n            title:\"注册时间\",\n            dataIndex: \"create_time\",\n            render:formateDate\n        },{\n            title:\"所属角色\",\n            dataIndex: \"role_id\",\n           // render:(role_id)=>this.state.roles.find(role=>role._id ===role_id).name\n            render:(role_id)=>this.roleNames[role_id]\n        },{\n            title:\"操作\",\n           render:(user)=>(\n            <span>\n                <LinkButton>修改</LinkButton>\n                <LinkButton onClick={()=>this.deleteUser(user)}>删除</LinkButton>\n            </span>\n           )\n        }\n        ]\n    }\n\n    addOrUPdateUser = () =>{}\n\n    deleteUser =(user) =>{\n        Modal.confirm({\n            title:\"确定要删除用户\"+user.username+\"?\",\n            onOk:async()=>{\n                const result =await reqDeleUser(user._id)\n                if(result.status === 0){\n                    message.success(\"删除用户成功\")\n                    this.getUsers()\n                }\n            }\n        })\n    }\n\n    initRoleNames = (roles) => {\n        const  roleNames = roles.reduce((pre,role)=>{\n            pre[role._id] = role.name\n            return pre\n        },[])\n        this.roleNames = roleNames\n    }\n\n    getUsers = async() => {\n        const result = await reqGetUsers();\n        if(result.status === 0){\n            const {users,roles} = result.data\n            this.initRoleNames(roles)\n            this.setState({\n                users,roles\n            })\n        }\n\n    }\n\n\n    componentDidMount() {\n        this.initColumn()\n        this.getUsers()\n    }\n\n    render(){\n        const title = (<Button type=\"primary\">创建用户</Button>);\n        const {loading,users,isShow} = this.state\n        return (\n\n            <Card title={title}>\n                <Table\n                    bordered\n                    rowKey=\"_id\"\n                    loadding={loading}\n                    dataSource={users}\n                    pagination={ {defaultPageSize:5} }\n                    columns={this.columns} />\n                <Modal\n                    title=\"添加用户\"\n                    visible={isShow}\n                    onOk={this.addOrUPdateUser}\n                    onCancel={()=>this.setState({isShow: false})}\n                >\n                    <div>1111</div>\n                </Modal>\n\n\n            </Card>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}