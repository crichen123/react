{"ast":null,"code":"import _classCallCheck from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{EditorState,convertToRaw,ContentState}from'draft-js';import{Editor}from'react-draft-wysiwyg';import draftToHtml from'draftjs-to-html';import htmlToDraft from'html-to-draftjs';import\"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\";var RichTextEditor=/*#__PURE__*/function(_Component){_inherits(RichTextEditor,_Component);function RichTextEditor(props){var _this;_classCallCheck(this,RichTextEditor);_this=_possibleConstructorReturn(this,_getPrototypeOf(RichTextEditor).call(this,props));_this.state={editorState:EditorState.createEmpty()};_this.uploadImageCallback=function(file){return new Promise(function(resolve,reject){var xhr=new XMLHttpRequest();xhr.open('POST','/users/uploadimg');var data=new FormData();data.append('image',file);xhr.send(data);xhr.addEventListener('load',function(){var response=JSON.parse(xhr.responseText);var url=response.data.url;resolve({data:{link:url}});});xhr.addEventListener('error',function(){var error=JSON.parse(xhr.responseText);reject(error);});});};_this.getDetail=function(){return draftToHtml(convertToRaw(_this.state.editorState.getCurrentContent()));};_this.onEditorStateChange=function(editorState){_this.setState({editorState:editorState});};var html=_this.props.detail;if(html){var contentBlock=htmlToDraft(html);var contentState=ContentState.createFromBlockArray(contentBlock.contentBlocks);var editorState=EditorState.createWithContent(contentState);_this.state={editorState:editorState};}else{_this.state={editorState:EditorState.createEmpty()};}return _this;}_createClass(RichTextEditor,[{key:\"render\",value:function render(){var editorState=this.state.editorState;return React.createElement(Editor,{editorState:editorState,editorStyle:{border:'1px solid black',minHeight:200,paddingLeft:10},onEditorStateChange:this.onEditorStateChange,toolbar:{image:{uploadCallback:this.uploadImageCallback,alt:{present:true,mandatory:true}}}});}}]);return RichTextEditor;}(Component);export{RichTextEditor as default};","map":{"version":3,"sources":["/home/crc/WebstormProjects/react-admin/src/pages/product/rich-text-editor.jsx"],"names":["React","Component","EditorState","convertToRaw","ContentState","Editor","draftToHtml","htmlToDraft","RichTextEditor","props","state","editorState","createEmpty","uploadImageCallback","file","Promise","resolve","reject","xhr","XMLHttpRequest","open","data","FormData","append","send","addEventListener","response","JSON","parse","responseText","url","link","error","getDetail","getCurrentContent","onEditorStateChange","setState","html","detail","contentBlock","contentState","createFromBlockArray","contentBlocks","createWithContent","border","minHeight","paddingLeft","image","uploadCallback","alt","present","mandatory"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { EditorState, convertToRaw, ContentState } from 'draft-js';\nimport { Editor } from 'react-draft-wysiwyg';\nimport draftToHtml from 'draftjs-to-html';\nimport htmlToDraft from 'html-to-draftjs';\nimport \"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\"\nimport PropTypes from \"prop-types\"\n\nexport default  class RichTextEditor extends Component {\n    state = {\n        editorState: EditorState.createEmpty(),\n    }\n\n    static propTypes = {\n        detail:PropTypes.string\n    }\n\n    constructor(props) {\n        super(props);\n        const html = this.props.detail;\n        if(html){\n            const contentBlock = htmlToDraft(html);\n            const contentState = ContentState.createFromBlockArray(contentBlock.contentBlocks);\n            const editorState = EditorState.createWithContent(contentState);\n            this.state = {\n                editorState,\n            };\n        }else{\n            this.state = {\n                editorState: EditorState.createEmpty(),\n            }\n        }\n\n    }\n\n    uploadImageCallback = (file) => {\n        return new Promise(\n            (resolve, reject) => {\n                const xhr = new XMLHttpRequest();\n                xhr.open('POST', '/users/uploadimg');\n                const data = new FormData();\n                data.append('image', file);\n                xhr.send(data);\n                xhr.addEventListener('load', () => {\n                    const response = JSON.parse(xhr.responseText);\n                    const url = response.data.url\n                    resolve({data:{link:url}});\n                });\n                xhr.addEventListener('error', () => {\n                    const error = JSON.parse(xhr.responseText);\n                    reject(error);\n                });\n            }\n        );\n    }\n\n    getDetail = () =>{\n        return draftToHtml(convertToRaw(this.state.editorState.getCurrentContent()))\n    }\n\n    onEditorStateChange = (editorState) => {\n        this.setState({\n            editorState,\n        });\n    };\n\n    render() {\n        const { editorState } = this.state;\n        return (\n                <Editor\n                    editorState={editorState}\n                    editorStyle={{border:'1px solid black',minHeight:200,paddingLeft:10 }}\n                    onEditorStateChange={this.onEditorStateChange}\n                    toolbar={{\n                        image: { uploadCallback:this.uploadImageCallback,alt:{present:true,mandatory:true} },\n                    }}\n                />\n        );\n    }\n}"]},"metadata":{},"sourceType":"module"}