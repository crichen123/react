{"ast":null,"code":"var _jsxFileName = \"/home/crc/WebstormProjects/react-admin/src/pages/product/rich-text-editor.jsx\";\nimport React, { Component } from 'react';\nimport { EditorState, convertToRaw, ContentState } from 'draft-js';\nimport { Editor } from 'react-draft-wysiwyg';\nimport draftToHtml from 'draftjs-to-html';\nimport htmlToDraft from 'html-to-draftjs';\nimport \"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\";\nimport PropTypes from \"prop-types\";\nexport default class RichTextEditor extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      editorState: EditorState.createEmpty()\n    };\n\n    this.uploadImageCallback = file => {\n      return new Promise((resolve, reject) => {\n        const xhr = new XMLHttpRequest();\n        xhr.open('POST', 'https://api.imgur.com/3/image');\n        xhr.setRequestHeader('Authorization', 'Client-ID XXXXX');\n        const data = new FormData();\n        data.append('image', file);\n        xhr.send(data);\n        xhr.addEventListener('load', () => {\n          const response = JSON.parse(xhr.responseText);\n          resolve(response);\n        });\n        xhr.addEventListener('error', () => {\n          const error = JSON.parse(xhr.responseText);\n          reject(error);\n        });\n      });\n    };\n\n    this.getDetail = () => {\n      return draftToHtml(convertToRaw(this.state.editorState.getCurrentContent()));\n    };\n\n    this.onEditorStateChange = editorState => {\n      this.setState({\n        editorState\n      });\n    };\n\n    const html = this.props.detail;\n\n    if (html) {\n      const contentBlock = htmlToDraft(html);\n      const contentState = ContentState.createFromBlockArray(contentBlock.contentBlocks);\n      const editorState = EditorState.createWithContent(contentState);\n      this.state = {\n        editorState\n      };\n    } else {\n      this.state = {\n        editorState: EditorState.createEmpty()\n      };\n    }\n  }\n\n  render() {\n    const {\n      editorState\n    } = this.state;\n    return React.createElement(Editor, {\n      editorState: editorState,\n      editorStyle: {\n        border: '1px solid black',\n        minHeight: 200,\n        paddingLeft: 10\n      },\n      onEditorStateChange: this.onEditorStateChange,\n      toolbar: {\n        image: {\n          uploadCallback: this.uploadImageCallback,\n          alt: {\n            present: true,\n            mandatory: true\n          }\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    });\n  }\n\n}\nRichTextEditor.propTypes = {\n  detail: PropTypes.string\n};","map":{"version":3,"sources":["/home/crc/WebstormProjects/react-admin/src/pages/product/rich-text-editor.jsx"],"names":["React","Component","EditorState","convertToRaw","ContentState","Editor","draftToHtml","htmlToDraft","PropTypes","RichTextEditor","constructor","props","state","editorState","createEmpty","uploadImageCallback","file","Promise","resolve","reject","xhr","XMLHttpRequest","open","setRequestHeader","data","FormData","append","send","addEventListener","response","JSON","parse","responseText","error","getDetail","getCurrentContent","onEditorStateChange","setState","html","detail","contentBlock","contentState","createFromBlockArray","contentBlocks","createWithContent","render","border","minHeight","paddingLeft","image","uploadCallback","alt","present","mandatory","propTypes","string"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,WAAT,EAAsBC,YAAtB,EAAoCC,YAApC,QAAwD,UAAxD;AACA,SAASC,MAAT,QAAuB,qBAAvB;AACA,OAAOC,WAAP,MAAwB,iBAAxB;AACA,OAAOC,WAAP,MAAwB,iBAAxB;AACA,OAAO,kDAAP;AACA,OAAOC,SAAP,MAAsB,YAAtB;AAEA,eAAgB,MAAMC,cAAN,SAA6BR,SAA7B,CAAuC;AASnDS,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;AADe,SARnBC,KAQmB,GARX;AACJC,MAAAA,WAAW,EAAEX,WAAW,CAACY,WAAZ;AADT,KAQW;;AAAA,SAkBnBC,mBAlBmB,GAkBIC,IAAD,IAAU;AAC5B,aAAO,IAAIC,OAAJ,CACH,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACjB,cAAMC,GAAG,GAAG,IAAIC,cAAJ,EAAZ;AACAD,QAAAA,GAAG,CAACE,IAAJ,CAAS,MAAT,EAAiB,+BAAjB;AACAF,QAAAA,GAAG,CAACG,gBAAJ,CAAqB,eAArB,EAAsC,iBAAtC;AACA,cAAMC,IAAI,GAAG,IAAIC,QAAJ,EAAb;AACAD,QAAAA,IAAI,CAACE,MAAL,CAAY,OAAZ,EAAqBV,IAArB;AACAI,QAAAA,GAAG,CAACO,IAAJ,CAASH,IAAT;AACAJ,QAAAA,GAAG,CAACQ,gBAAJ,CAAqB,MAArB,EAA6B,MAAM;AAC/B,gBAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWX,GAAG,CAACY,YAAf,CAAjB;AACAd,UAAAA,OAAO,CAACW,QAAD,CAAP;AACH,SAHD;AAIAT,QAAAA,GAAG,CAACQ,gBAAJ,CAAqB,OAArB,EAA8B,MAAM;AAChC,gBAAMK,KAAK,GAAGH,IAAI,CAACC,KAAL,CAAWX,GAAG,CAACY,YAAf,CAAd;AACAb,UAAAA,MAAM,CAACc,KAAD,CAAN;AACH,SAHD;AAIH,OAhBE,CAAP;AAkBH,KArCkB;;AAAA,SAuCnBC,SAvCmB,GAuCP,MAAK;AACb,aAAO5B,WAAW,CAACH,YAAY,CAAC,KAAKS,KAAL,CAAWC,WAAX,CAAuBsB,iBAAvB,EAAD,CAAb,CAAlB;AACH,KAzCkB;;AAAA,SA2CnBC,mBA3CmB,GA2CIvB,WAAD,IAAiB;AACnC,WAAKwB,QAAL,CAAc;AACVxB,QAAAA;AADU,OAAd;AAGH,KA/CkB;;AAEf,UAAMyB,IAAI,GAAG,KAAK3B,KAAL,CAAW4B,MAAxB;;AACA,QAAGD,IAAH,EAAQ;AACJ,YAAME,YAAY,GAAGjC,WAAW,CAAC+B,IAAD,CAAhC;AACA,YAAMG,YAAY,GAAGrC,YAAY,CAACsC,oBAAb,CAAkCF,YAAY,CAACG,aAA/C,CAArB;AACA,YAAM9B,WAAW,GAAGX,WAAW,CAAC0C,iBAAZ,CAA8BH,YAA9B,CAApB;AACA,WAAK7B,KAAL,GAAa;AACTC,QAAAA;AADS,OAAb;AAGH,KAPD,MAOK;AACD,WAAKD,KAAL,GAAa;AACTC,QAAAA,WAAW,EAAEX,WAAW,CAACY,WAAZ;AADJ,OAAb;AAGH;AAEJ;;AAiCD+B,EAAAA,MAAM,GAAG;AACL,UAAM;AAAEhC,MAAAA;AAAF,QAAkB,KAAKD,KAA7B;AACA,WACQ,oBAAC,MAAD;AACI,MAAA,WAAW,EAAEC,WADjB;AAEI,MAAA,WAAW,EAAE;AAACiC,QAAAA,MAAM,EAAC,iBAAR;AAA0BC,QAAAA,SAAS,EAAC,GAApC;AAAwCC,QAAAA,WAAW,EAAC;AAApD,OAFjB;AAGI,MAAA,mBAAmB,EAAE,KAAKZ,mBAH9B;AAII,MAAA,OAAO,EAAE;AACLa,QAAAA,KAAK,EAAE;AAAEC,UAAAA,cAAc,EAAC,KAAKnC,mBAAtB;AAA0CoC,UAAAA,GAAG,EAAC;AAACC,YAAAA,OAAO,EAAC,IAAT;AAAcC,YAAAA,SAAS,EAAC;AAAxB;AAA9C;AADF,OAJb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADR;AAUH;;AAtEkD;AAAjC5C,c,CAKX6C,S,GAAY;AACff,EAAAA,MAAM,EAAC/B,SAAS,CAAC+C;AADF,C","sourcesContent":["import React, { Component } from 'react';\nimport { EditorState, convertToRaw, ContentState } from 'draft-js';\nimport { Editor } from 'react-draft-wysiwyg';\nimport draftToHtml from 'draftjs-to-html';\nimport htmlToDraft from 'html-to-draftjs';\nimport \"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\"\nimport PropTypes from \"prop-types\"\n\nexport default  class RichTextEditor extends Component {\n    state = {\n        editorState: EditorState.createEmpty(),\n    }\n\n    static propTypes = {\n        detail:PropTypes.string\n    }\n\n    constructor(props) {\n        super(props);\n        const html = this.props.detail;\n        if(html){\n            const contentBlock = htmlToDraft(html);\n            const contentState = ContentState.createFromBlockArray(contentBlock.contentBlocks);\n            const editorState = EditorState.createWithContent(contentState);\n            this.state = {\n                editorState,\n            };\n        }else{\n            this.state = {\n                editorState: EditorState.createEmpty(),\n            }\n        }\n\n    }\n\n    uploadImageCallback = (file) => {\n        return new Promise(\n            (resolve, reject) => {\n                const xhr = new XMLHttpRequest();\n                xhr.open('POST', 'https://api.imgur.com/3/image');\n                xhr.setRequestHeader('Authorization', 'Client-ID XXXXX');\n                const data = new FormData();\n                data.append('image', file);\n                xhr.send(data);\n                xhr.addEventListener('load', () => {\n                    const response = JSON.parse(xhr.responseText);\n                    resolve(response);\n                });\n                xhr.addEventListener('error', () => {\n                    const error = JSON.parse(xhr.responseText);\n                    reject(error);\n                });\n            }\n        );\n    }\n\n    getDetail = () =>{\n        return draftToHtml(convertToRaw(this.state.editorState.getCurrentContent()))\n    }\n\n    onEditorStateChange = (editorState) => {\n        this.setState({\n            editorState,\n        });\n    };\n\n    render() {\n        const { editorState } = this.state;\n        return (\n                <Editor\n                    editorState={editorState}\n                    editorStyle={{border:'1px solid black',minHeight:200,paddingLeft:10 }}\n                    onEditorStateChange={this.onEditorStateChange}\n                    toolbar={{\n                        image: { uploadCallback:this.uploadImageCallback,alt:{present:true,mandatory:true} },\n                    }}\n                />\n        );\n    }\n}"]},"metadata":{},"sourceType":"module"}