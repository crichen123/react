{"ast":null,"code":"import\"antd/es/modal/style/css\";import _Modal from\"antd/es/modal\";import _regeneratorRuntime from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import\"./index.less\";import{formateDate}from\"../../utils/dateUtils\";import memoryUtils from\"../../utils/memoryUtils\";import storageUtiles from\"../../utils/storageUtiles\";import{reqWeather}from\"../../api\";import{withRouter}from'react-router-dom';import menuList from\"../../config/menuConfig\";import LinkButton from\"../link-button\";import{connect}from\"react-redux\";var HeaderContent=/*#__PURE__*/function(_React$Component){_inherits(HeaderContent,_React$Component);function HeaderContent(){var _getPrototypeOf2;var _this;_classCallCheck(this,HeaderContent);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(HeaderContent)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={currentTime:formateDate(Date.now()),dayPictureUrl:'',weather:''};_this.getTime=function(){_this.intervalId=setInterval(function(){var currentTime=formateDate(Date.now());_this.setState({currentTime:currentTime});},1000);};_this.getWeather=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _ref2,dayPictureUrl,weather;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return reqWeather('西安');case 2:_ref2=_context.sent;dayPictureUrl=_ref2.dayPictureUrl;weather=_ref2.weather;_this.setState({dayPictureUrl:dayPictureUrl,weather:weather});case 6:case\"end\":return _context.stop();}}},_callee);}));_this.getTitle=function(){var title;var path=_this.props.location.pathname;menuList.forEach(function(item){if(item.key===path){title=item.title;}else if(item.children){var cItem=item.children.find(function(cItem){return path.indexOf(cItem.key)===0;});if(cItem){title=cItem.title;}}});return title;};_this.Logout=function(){_Modal.confirm({content:'确定退出吗？',onOk:function onOk(){console.log('OK');storageUtiles.removeUser();memoryUtils.user={};_this.props.history.replace('/login');}});};return _this;}_createClass(HeaderContent,[{key:\"componentDidMount\",value:function componentDidMount(){this.getTime();this.getWeather();}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){clearInterval(this.intervalId);}},{key:\"render\",value:function render(){var _this$state=this.state,currentTime=_this$state.currentTime,dayPictureUrl=_this$state.dayPictureUrl,weather=_this$state.weather;var user=memoryUtils.user.username;//const title = this.getTitle();\nvar title=this.props.headTitle;return React.createElement(\"div\",{className:\"header\"},React.createElement(\"div\",{className:\"header-top\"},React.createElement(\"span\",null,\"\\u6B22\\u8FCE\\uFF0C\",user),React.createElement(LinkButton,{onClick:this.Logout},\"\\u9000\\u51FA\")),React.createElement(\"div\",{className:\"header-bottom\"},React.createElement(\"div\",{className:\"header-bottom-left\"},title),React.createElement(\"div\",{className:\"header-bottom-right\"},React.createElement(\"span\",null,currentTime),React.createElement(\"img\",{alt:\"daypicture\",src:dayPictureUrl}),React.createElement(\"span\",null,weather))));}}]);return HeaderContent;}(React.Component);export default connect(function(state){return{headTitle:state.headTitle};},{})(withRouter(HeaderContent));","map":{"version":3,"sources":["/home/crc/WebstormProjects/react-admin/src/components/header/header.jsx"],"names":["React","formateDate","memoryUtils","storageUtiles","reqWeather","withRouter","menuList","LinkButton","connect","HeaderContent","state","currentTime","Date","now","dayPictureUrl","weather","getTime","intervalId","setInterval","setState","getWeather","getTitle","title","path","props","location","pathname","forEach","item","key","children","cItem","find","indexOf","Logout","confirm","content","onOk","console","log","removeUser","user","history","replace","clearInterval","username","headTitle","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport \"./index.less\"\nimport {formateDate} from \"../../utils/dateUtils\"\nimport memoryUtils from \"../../utils/memoryUtils\";\nimport storageUtiles from \"../../utils/storageUtiles\";\nimport {reqWeather} from \"../../api\";\nimport {withRouter} from 'react-router-dom'\nimport menuList from \"../../config/menuConfig\";\nimport { Modal} from 'antd';\nimport LinkButton from \"../link-button\";\nimport {connect} from \"react-redux\"\n\nclass HeaderContent extends React.Component{\n    state = {\n        currentTime:formateDate(Date.now()),\n        dayPictureUrl:'',\n        weather:''\n    }\n\n    getTime=()=>{\n        this.intervalId = setInterval(()=>{\n            const currentTime = formateDate(Date.now())\n            this.setState({currentTime})\n        },1000)\n    }\n\n    getWeather = async() => {\n        const {dayPictureUrl,weather} = await reqWeather('西安')\n        this.setState({dayPictureUrl,weather})\n    }\n\n    getTitle = () =>{\n        let title;\n        const path = this.props.location.pathname\n        menuList.forEach(item=>{\n            if(item.key===path){\n               title = item.title\n            }else if(item.children){\n                const cItem = item.children.find(cItem=>path.indexOf(cItem.key)===0);\n                if(cItem){\n                    title = cItem.title;\n                }\n            }\n        })\n        return title;\n    }\n\n    Logout= () =>{\n        Modal.confirm({\n            content: '确定退出吗？',\n            onOk : () => {\n                console.log('OK');\n                storageUtiles.removeUser();\n                memoryUtils.user = {};\n                this.props.history.replace('/login')\n            },\n\n        })\n    }\n\n    componentDidMount() {\n        this.getTime();\n        this.getWeather()\n    }\n\n    componentWillUnmount() {\n        clearInterval(this.intervalId);\n    }\n\n    render() {\n        const {currentTime,dayPictureUrl,weather} = this.state\n        const user = memoryUtils.user.username;\n        //const title = this.getTitle();\n        const title = this.props.headTitle\n        return (\n            <div className=\"header\">\n               <div className=\"header-top\">\n                   <span>欢迎，{user}</span>\n                   <LinkButton onClick={this.Logout}>退出</LinkButton>\n               </div>\n                <div className=\"header-bottom\">\n                    <div className=\"header-bottom-left\">{title}</div>\n                    <div className=\"header-bottom-right\">\n                        <span>{currentTime}</span>\n                        <img alt=\"daypicture\" src={dayPictureUrl} />\n                        <span>{weather}</span>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default  connect(\n    state=>({headTitle:state.headTitle}),{}\n)(withRouter(HeaderContent))"]},"metadata":{},"sourceType":"module"}