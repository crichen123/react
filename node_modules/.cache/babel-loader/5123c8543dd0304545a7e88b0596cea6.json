{"ast":null,"code":"import\"antd/es/icon/style/css\";import _Icon from\"antd/es/icon\";import _classCallCheck from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/crc/WebstormProjects/react-admin/node_modules/@babel/runtime/helpers/esm/inherits\";import\"antd/es/menu/style/css\";import _Menu from\"antd/es/menu\";import React from'react';import\"./index.less\";import{Link,withRouter}from\"react-router-dom\";import menuList from'../../config/menuConfig';import memoryUtils from\"../../utils/memoryUtils\";import{connect}from\"react-redux\";import{setHeaderTitle}from\"../../redux/actions\";var SubMenu=_Menu.SubMenu;var LeftNav=/*#__PURE__*/function(_React$Component){_inherits(LeftNav,_React$Component);function LeftNav(){var _getPrototypeOf2;var _this;_classCallCheck(this,LeftNav);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(LeftNav)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={collapsed:false};_this.getMenuNodes_map=function(menuList){return menuList.map(function(item){if(!item.children){return React.createElement(_Menu.Item,{key:item.key},React.createElement(Link,{to:item.key},React.createElement(_Icon,{type:item.icon}),React.createElement(\"span\",null,item.title)));}else{return React.createElement(SubMenu,{key:item.key,title:React.createElement(\"span\",null,React.createElement(_Icon,{type:item.icon}),React.createElement(\"span\",null,item.title))},_this.getMenuNodes(item.children));}});};_this.hasAuth=function(item){var key=item.key,isPublic=item.isPublic;var username=memoryUtils.user.username;var menus=memoryUtils.user.role.menus;if(username==='crc'||isPublic||menus.indexOf(key)!==-1){return true;}else if(item.children){return!!item.children.find(function(child){return menus.indexOf(child.key)!==-1;});}};_this.getMenuNodes=function(menuList){var path=_this.props.location.pathname;return menuList.reduce(function(pre,item){if(_this.hasAuth(item)){if(!item.children){if(item.key===path||path.indexOf(item.key)===0){_this.props.setHeaderTitle(item.title);}pre.push(React.createElement(_Menu.Item,{key:item.key},React.createElement(Link,{to:item.key,onClick:function onClick(){return _this.props.setHeaderTitle(item.title);}},React.createElement(_Icon,{type:item.icon}),React.createElement(\"span\",null,item.title))));}else{var cItem=item.children.find(function(cItem){return path.indexOf(cItem.key)===0;});// 如果存在, 说明当前item的子列表需要打开\nif(cItem){_this.openKey=item.key;}pre.push(React.createElement(SubMenu,{key:item.key,title:React.createElement(\"span\",null,React.createElement(_Icon,{type:item.icon}),React.createElement(\"span\",null,item.title))},_this.getMenuNodes(item.children)));}}return pre;},[]);};return _this;}_createClass(LeftNav,[{key:\"componentWillMount\",//第一次render之前 只执行一次\nvalue:function componentWillMount(){this.menuNodes=this.getMenuNodes(menuList);}},{key:\"render\",value:function render(){var path=this.props.location.pathname;var openKey=this.openKey;if(path.indexOf('/product')===0){path=\"/product\";}return React.createElement(\"div\",{className:\"left-nav\"},React.createElement(Link,{to:\"/\",className:\"left-nav-header\"},React.createElement(\"h1\",{style:{marginLeft:\"30px\"}},\"React\\u540E\\u53F0\")),React.createElement(_Menu,{mode:\"inline\",theme:\"dark\",selectedKeys:[path],defaultOpenKeys:[openKey]},this.menuNodes));}}]);return LeftNav;}(React.Component);//leftNav是非路由组件 withRouter传入location history match 属性\nexport default connect(function(state){return{};},{setHeaderTitle:setHeaderTitle})(withRouter(LeftNav));","map":{"version":3,"sources":["/home/crc/WebstormProjects/react-admin/src/components/left-nav/left-nav.jsx"],"names":["React","Link","withRouter","menuList","memoryUtils","connect","setHeaderTitle","SubMenu","LeftNav","state","collapsed","getMenuNodes_map","map","item","children","key","icon","title","getMenuNodes","hasAuth","isPublic","username","user","menus","role","indexOf","find","child","path","props","location","pathname","reduce","pre","push","cItem","openKey","menuNodes","marginLeft","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport \"./index.less\"\nimport {Link,withRouter} from \"react-router-dom\"\nimport { Menu, Icon } from 'antd';\nimport menuList from '../../config/menuConfig'\nimport memoryUtils from \"../../utils/memoryUtils\";\nimport {connect} from \"react-redux\"\nimport {setHeaderTitle} from \"../../redux/actions\"\n\nconst { SubMenu } = Menu;\n\n\n\nclass LeftNav extends React.Component{\n    state = {\n        collapsed: false,\n    };\n\n\n    //示例 使用map方法生成条目\n    getMenuNodes_map = (menuList) => {\n        return menuList.map(item=>{\n            if(!item.children){\n                return (\n                    <Menu.Item key={item.key}>\n                        <Link to={item.key}>\n                            <Icon type={item.icon} />\n                           <span>{item.title}</span>\n                        </Link>\n                    </Menu.Item>\n                )\n            }else{\n                return (\n                    <SubMenu\n                    key={item.key}\n                    title={\n                        <span>\n                            <Icon type={item.icon} />\n                            <span>{item.title}</span>\n                        </span>\n                    }>\n                       {this.getMenuNodes(item.children)}\n                    </SubMenu>\n\n                )\n            }\n        })\n    }\n\n    hasAuth = (item) =>{\n        const {key,isPublic} = item\n        const username = memoryUtils.user.username\n        const {menus} = memoryUtils.user.role\n        if(username ==='crc' || isPublic || menus.indexOf(key) !== -1 ){\n            return true\n        }else if(item.children){\n            return !!item.children.find(child=> menus.indexOf(child.key)!==-1)\n        }\n\n    }\n\n    getMenuNodes =(menuList) =>{\n        const path = this.props.location.pathname\n        return menuList.reduce((pre,item)=>{\n            if(this.hasAuth(item)) {\n                if (!item.children) {\n                    if(item.key === path || path.indexOf(item.key)===0){\n                        this.props.setHeaderTitle(item.title)\n                    }\n                    pre.push((<Menu.Item key={item.key}>\n                        <Link to={item.key} onClick={()=>this.props.setHeaderTitle(item.title)}>\n                            <Icon type={item.icon}/>\n                            <span>{item.title}</span>\n                        </Link>\n                    </Menu.Item>))\n                } else {\n                    const cItem = item.children.find(cItem => path.indexOf(cItem.key) === 0)\n                    // 如果存在, 说明当前item的子列表需要打开\n                    if (cItem) {\n                        this.openKey = item.key\n                    }\n                    pre.push((<SubMenu\n                        key={item.key}\n                        title={\n                            <span>\n                            <Icon type={item.icon}/>\n                            <span>{item.title}</span>\n                        </span>\n                        }>\n                        {this.getMenuNodes(item.children)}\n                    </SubMenu>))\n                }\n            }\n            return pre;\n        },[])\n    }\n\n    //第一次render之前 只执行一次\n    componentWillMount(){\n        this.menuNodes = this.getMenuNodes(menuList);\n    }\n    render() {\n        let path = this.props.location.pathname;\n        const openKey = this.openKey\n        if(path.indexOf('/product')===0){\n            path = \"/product\"\n        }\n        return (\n            <div   className=\"left-nav\">\n                <Link to=\"/\" className=\"left-nav-header\">\n                    <h1 style={{marginLeft:\"30px\"}}>React后台</h1>\n                </Link>\n                <Menu\n                    mode=\"inline\"\n                    theme=\"dark\"\n                    selectedKeys={[path]}\n                    defaultOpenKeys={[openKey]}\n                >\n                    {\n                        this.menuNodes\n                    }\n                </Menu>\n                {/*<Menu*/}\n                {/*    defaultSelectedKeys={['1']}*/}\n                {/*    defaultOpenKeys={['sub1']}*/}\n                {/*    mode=\"inline\"*/}\n                {/*    theme=\"dark\"*/}\n                {/*>*/}\n                {/*    <Menu.Item key=\"/home\">*/}\n                {/*            <Link to=\"/home\">*/}\n                {/*                <Icon type=\"pie-chart\" />*/}\n                {/*                <span>首页</span>*/}\n                {/*            </Link>*/}\n                {/*    </Menu.Item>*/}\n                {/*    <SubMenu*/}\n                {/*        key=\"sub1\"*/}\n                {/*        title={*/}\n                {/*            <span>*/}\n                {/*                <Icon type=\"mail\" />*/}\n                {/*                <span>商品</span>*/}\n                {/*            </span>*/}\n                {/*            }*/}\n                {/*        >*/}\n                {/*        <Menu.Item key=\"/category\">*/}\n                {/*            <Link to=\"/category\">*/}\n                {/*                <Icon type=\"mail\" />*/}\n                {/*                <span>品类管理</span>*/}\n                {/*            </Link>*/}\n                {/*        </Menu.Item>*/}\n                {/*        <Menu.Item key=\"/product\">*/}\n                {/*            <Link to=\"/product\">*/}\n                {/*                <Icon type=\"mail\" />*/}\n                {/*                <span>商品管理</span>*/}\n                {/*            </Link>*/}\n                {/*        </Menu.Item>*/}\n                {/*    </SubMenu>*/}\n                {/*    <Menu.Item key=\"/user\">*/}\n                {/*        <Link to=\"/user\">*/}\n                {/*            <Icon type=\"pie-chart\" />*/}\n                {/*            <span>用户管理</span>*/}\n                {/*        </Link>*/}\n                {/*    </Menu.Item>*/}\n                {/*    <Menu.Item key=\"/role\">*/}\n                {/*        <Link to=\"/role\">*/}\n                {/*            <Icon type=\"pie-chart\" />*/}\n                {/*            <span>角色管理</span>*/}\n                {/*        </Link>*/}\n                {/*    </Menu.Item>*/}\n\n                {/*</Menu>*/}\n            </div>\n        )\n    }\n}\n//leftNav是非路由组件 withRouter传入location history match 属性\nexport default connect(state=>({}),{setHeaderTitle})(withRouter(LeftNav))"]},"metadata":{},"sourceType":"module"}