{"ast":null,"code":"import \"antd/es/card/style/css\";\nimport _Card from \"antd/es/card\";\nimport \"antd/es/modal/style/css\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/table/style/css\";\nimport _Table from \"antd/es/table\";\nimport \"antd/es/button/style/css\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/icon/style/css\";\nimport _Icon from \"antd/es/icon\";\nimport \"antd/es/message/style/css\";\nimport _message from \"antd/es/message\";\nvar _jsxFileName = \"/home/crc/WebstormProjects/react-admin/src/pages/category/category.jsx\";\nimport React from 'react';\nimport \"./category.less\";\nimport LinkButton from \"../../components/link-button\";\nimport { reqAddCategorys, reqCategorys, reqUpdateCategorys } from \"../../api\";\nimport AddForm from \"./add-form\";\nimport UpdateForm from \"./update-form\";\nexport default class Category extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      categorys: [],\n      loading: false,\n      parentId: '0',\n      parentName: '',\n      subCategorys: [],\n      showStatus: 0\n    };\n\n    this.initColumns = () => {\n      this.columns = [{\n        title: '分类名称',\n        dataIndex: 'name',\n        key: 'name'\n      }, {\n        title: '操作',\n        width: 300,\n        dataIndex: '',\n        key: 'x',\n        render: category => React.createElement(\"span\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 32\n          },\n          __self: this\n        }, React.createElement(LinkButton, {\n          onClick: () => this.showUpdate(category),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 33\n          },\n          __self: this\n        }, \"\\u4FEE\\u6539\\u5206\\u7C7B\"), this.state.parentId === '0' ? React.createElement(LinkButton, {\n          onClick: () => this.showSubCategorys(category),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 35\n          },\n          __self: this\n        }, \"\\u67E5\\u770B\\u5B50\\u5206\\u7C7B\") : null)\n      }];\n    };\n\n    this.showSubCategorys = category => {\n      this.setState({\n        parentId: category._id,\n        parentName: category.name\n      }, () => {\n        this.getCategorys();\n      });\n    };\n\n    this.showCategorys = () => {\n      this.setState({\n        parentId: \"0\",\n        parentName: '',\n        subCategorys: []\n      }, () => {\n        console.log(this.state);\n      });\n    };\n\n    this.getCategorys = async () => {\n      this.setState({\n        loading: true\n      });\n      const {\n        parentId\n      } = this.state;\n      const result = await reqCategorys(parentId);\n      this.setState({\n        loading: false\n      });\n\n      if (result.data.status == \"0\") {\n        const categorys = result.data.data;\n        console.log(categorys);\n\n        if (parentId === '0') {\n          this.setState({\n            categorys\n          });\n        } else {\n          this.setState({\n            subCategorys: categorys\n          });\n        }\n      } else {\n        _message.error(\"获取分类失败\");\n      }\n    };\n\n    this.showAdd = () => {\n      this.setState({\n        showStatus: 1\n      });\n    };\n\n    this.showUpdate = category => {\n      this.category = category;\n      this.setState({\n        showStatus: 2\n      });\n    };\n\n    this.addCategory = async () => {\n      this.setState({\n        showStatus: 0\n      });\n      const {\n        parentId,\n        categoryName\n      } = this.form.getFieldsValue();\n      this.form.resetFields();\n      const result = await reqAddCategorys(categoryName, parentId);\n\n      if (result.data.status === 0) {\n        this.getCategorys();\n      }\n    };\n\n    this.updateCategory = () => {\n      this.form.validateFields(async (err, value) => {\n        if (!err) {\n          this.setState({\n            showStatus: 0\n          });\n          const categoryId = this.category._id; //const categoryName = this.form.getFieldValue('categoryName')\n\n          const {\n            categoryName\n          } = value;\n          this.form.resetFields();\n          console.log(111111);\n          console.log(categoryId);\n          console.log(categoryName);\n          const reusult = await reqUpdateCategorys(categoryId, categoryName);\n          this.getCategorys();\n        }\n      });\n    };\n\n    this.handleCancel = () => {\n      this.form.resetFields();\n      this.setState({\n        showStatus: 0\n      });\n    };\n  }\n\n  componentWillMount() {\n    this.initColumns();\n  }\n\n  componentDidMount() {\n    this.getCategorys();\n  }\n\n  render() {\n    const {\n      categorys,\n      loading,\n      subCategorys,\n      parentId,\n      parentName\n    } = this.state;\n    const columns = this.columns;\n    const category = this.category || {};\n    const title = parentId === 0 ? \"一级分类列表\" : React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(LinkButton, {\n      onClick: this.showCategorys,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, \"\\u4E00\\u7EA7\\u5206\\u7C7B\\u5217\\u8868\"), React.createElement(_Icon, {\n      type: \"arrow-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, parentName));\n    const extra = React.createElement(_Button, {\n      type: \"primary\",\n      onClick: this.showAdd,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, React.createElement(_Icon, {\n      type: \"plus\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }), \"\\u6DFB\\u52A0\");\n    const dataSource = [{\n      \"parentId\": '0',\n      \"_id\": '5ca9d69',\n      \"name\": '家用电器',\n      \"_v\": 0\n    }, {\n      \"parentId\": '0',\n      \"_id\": '5ca9d6c',\n      \"name\": '电脑',\n      \"_v\": 0\n    }, {\n      \"parentId\": '0',\n      \"_id\": '5ca9d7c',\n      \"name\": '图书',\n      \"_v\": 0\n    }, {\n      \"parentId\": '0',\n      \"_id\": '5ca9dbe',\n      \"name\": '服装',\n      \"_v\": 0\n    }];\n    /*\n    return (\n        <Card title={title} extra={extra}>\n            <Table\n                rowKey=\"_id\"\n                bordered\n                dataSource={dataSource} columns={columns} />;\n        </Card>\n    )\n    *\n     */\n\n    return React.createElement(_Card, {\n      title: title,\n      extra: extra,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, React.createElement(_Table, {\n      rowKey: \"_id\",\n      bordered: true,\n      dataSource: parentId === '0' ? categorys : subCategorys,\n      columns: columns,\n      pagination: {\n        defaultPageSize: 5\n      },\n      loading: loading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }), React.createElement(_Modal, {\n      title: \"\\u6DFB\\u52A0\\u5206\\u7C7B\",\n      visible: this.state.showStatus === 1,\n      onOk: this.addCategory,\n      onCancel: this.handleCancel,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, React.createElement(AddForm, {\n      categorys: categorys,\n      parentId: parentId,\n      setForm: form => {\n        this.form = form;\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    })), React.createElement(_Modal, {\n      title: \"\\u66F4\\u65B0\\u5206\\u7C7B\",\n      visible: this.state.showStatus === 2,\n      onOk: this.updateCategory,\n      onCancel: this.handleCancel,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, React.createElement(UpdateForm, {\n      categoryName: category.name,\n      setForm: form => {\n        this.form = form;\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    })));\n  }\n\n}","map":{"version":3,"sources":["/home/crc/WebstormProjects/react-admin/src/pages/category/category.jsx"],"names":["React","LinkButton","reqAddCategorys","reqCategorys","reqUpdateCategorys","AddForm","UpdateForm","Category","Component","state","categorys","loading","parentId","parentName","subCategorys","showStatus","initColumns","columns","title","dataIndex","key","width","render","category","showUpdate","showSubCategorys","setState","_id","name","getCategorys","showCategorys","console","log","result","data","status","error","showAdd","addCategory","categoryName","form","getFieldsValue","resetFields","updateCategory","validateFields","err","value","categoryId","reusult","handleCancel","componentWillMount","componentDidMount","extra","dataSource","defaultPageSize"],"mappings":"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","sourcesContent":["import React from 'react'\nimport {Card,Table,Button,Icon,message,Modal} from \"antd\"\nimport \"./category.less\"\nimport LinkButton from \"../../components/link-button\";\nimport {reqAddCategorys, reqCategorys, reqUpdateCategorys} from \"../../api\"\nimport AddForm from \"./add-form\";\nimport UpdateForm from \"./update-form\";\n\nexport default class Category extends React.Component {\n\n    state = {\n        categorys:[],\n        loading:false,\n        parentId:'0',\n        parentName:'',\n        subCategorys:[],\n        showStatus:0\n    }\n\n    initColumns = () =>{\n        this.columns = [\n            {\n                title: '分类名称',\n                dataIndex: 'name',\n                key: 'name',\n            },\n            {\n                title: '操作',\n                width:300,\n                dataIndex: '',\n                key: 'x',\n                render:(category)=>(<span>\n                    <LinkButton onClick={()=>this.showUpdate(category)}>修改分类</LinkButton>\n                    {this.state.parentId ==='0'\n                        ?<LinkButton onClick={()=>this.showSubCategorys(category)}>查看子分类</LinkButton>\n                        :null}\n\n                </span>)\n            }\n\n        ];\n    }\n\n    showSubCategorys=(category)=>{\n        this.setState({\n            parentId:category._id,\n            parentName:category.name\n        },()=>{\n            this.getCategorys()\n        })\n\n    }\n\n    showCategorys = () =>{\n        this.setState({parentId:\"0\",parentName:'',subCategorys:[]},()=>{\n            console.log(this.state)\n        })\n    }\n\n    getCategorys = async () =>{\n       this.setState({loading:true});\n       const {parentId} = this.state;\n       const result = await reqCategorys(parentId);\n        this.setState({loading:false});\n       if(result.data.status==\"0\"){\n            const categorys = result.data.data;\n            console.log(categorys);\n            if(parentId==='0'){\n                this.setState({categorys});\n            }else{\n                this.setState({subCategorys:categorys})\n            }\n\n\n       }else{\n           message.error(\"获取分类失败\")\n       }\n    }\n\n    showAdd = () =>{\n        this.setState({\n            showStatus:1\n        })\n    }\n\n    showUpdate = (category) =>{\n        this.category = category\n        this.setState({\n            showStatus:2\n        })\n    }\n\n    addCategory = async() =>{\n        this.setState({\n            showStatus:0\n        })\n        const {parentId,categoryName} = this.form.getFieldsValue()\n        this.form.resetFields()\n        const result = await reqAddCategorys(categoryName,parentId)\n        if(result.data.status===0){\n            this.getCategorys()\n        }\n    }\n\n    updateCategory = () =>{\n        this.form.validateFields(async(err,value)=>{\n            if(!err){\n                this.setState({\n                    showStatus:0\n                })\n                const categoryId = this.category._id\n                //const categoryName = this.form.getFieldValue('categoryName')\n                const {categoryName} = value\n                this.form.resetFields()\n                console.log(111111);\n                console.log(categoryId);\n                console.log(categoryName);\n                const  reusult = await reqUpdateCategorys(categoryId,categoryName);\n                this.getCategorys()\n            }\n        })\n\n    }\n\n    handleCancel = () =>{\n        this.form.resetFields()\n        this.setState({showStatus:0})\n    }\n\n    componentWillMount() {\n        this.initColumns();\n    }\n\n    componentDidMount() {\n        this.getCategorys();\n    }\n\n    render(){\n        const {categorys,loading,subCategorys,parentId,parentName} = this.state;\n        const columns = this.columns\n        const category = this.category || {}\n        const title = parentId ===0?\"一级分类列表\":(\n            <span>\n                <LinkButton onClick={this.showCategorys}>一级分类列表</LinkButton>\n                <Icon type=\"arrow-right\"></Icon>\n                <span>{parentName}</span>\n            </span>);\n        const extra = (\n            <Button type=\"primary\" onClick={this.showAdd}>\n                <Icon type=\"plus\"/>添加\n            </Button>\n        )\n\n        const dataSource = [\n            {\n                \"parentId\": '0',\n                \"_id\": '5ca9d69',\n                \"name\": '家用电器',\n                \"_v\":0\n            },{\n                \"parentId\": '0',\n                \"_id\": '5ca9d6c',\n                \"name\": '电脑',\n                \"_v\":0\n            },{\n                \"parentId\": '0',\n                \"_id\": '5ca9d7c',\n                \"name\": '图书',\n                \"_v\":0\n            },{\n                \"parentId\": '0',\n                \"_id\": '5ca9dbe',\n                \"name\": '服装',\n                \"_v\":0\n            }\n\n        ];\n\n\n\n        /*\n        return (\n            <Card title={title} extra={extra}>\n                <Table\n                    rowKey=\"_id\"\n                    bordered\n                    dataSource={dataSource} columns={columns} />;\n            </Card>\n        )\n        *\n         */\n\n        return (\n            <Card title={title} extra={extra}>\n                <Table\n                    rowKey=\"_id\"\n                    bordered\n                    dataSource={parentId==='0'?categorys:subCategorys}\n                    columns={columns}\n                    pagination={{defaultPageSize:5}}\n                    loading={loading}\n                />\n\n                <Modal\n                    title=\"添加分类\"\n                    visible={this.state.showStatus===1}\n                    onOk={this.addCategory}\n                    onCancel={this.handleCancel}\n                >\n                    <AddForm categorys={categorys} parentId={parentId} setForm={(form)=> {this.form = form} } />\n                </Modal>\n\n                <Modal\n                    title=\"更新分类\"\n                    visible={this.state.showStatus===2}\n                    onOk={this.updateCategory}\n                    onCancel={this.handleCancel}\n                >\n                   <UpdateForm categoryName={category.name}\n                               setForm={(form)=> {this.form = form} } />\n                </Modal>\n\n            </Card>\n\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}